{"programModules":{"EXT102MI":{"program":"EXT102MI","triggers":{},"transactions":{"UpdPOLine":{"sourceUuid":"60cf27fe-1782-47ed-aa6a-06bbb37b9702","name":"UpdPOLine","program":"EXT102MI","description":"Upsert item supplier record, and log portal crud transaction","active":true,"multi":false,"modified":1714622250883,"modifiedBy":"RMURRAY","outputFields":[],"inputFields":[{"name":"PUNO","description":"purchase order number","length":10,"mandatory":true,"type":"A"},{"name":"PNLI","description":"purchase order line","length":6,"mandatory":true,"type":"A"},{"name":"PNLS","description":"purchase order line subnumber","length":3,"mandatory":true,"type":"A"},{"name":"PUPR","description":"purchase price","length":17,"mandatory":false,"type":"N"},{"name":"DWDT","description":"requested delivery date","length":8,"mandatory":false,"type":"N"},{"name":"PITD","description":"purchase order item name","length":60,"mandatory":false,"type":"A"},{"name":"PITT","description":"purchase order item description","length":120,"mandatory":false,"type":"A"},{"name":"TEL1","description":"terms text","length":36,"mandatory":false,"type":"A"},{"name":"EMAL","description":"portal user","length":100,"mandatory":false,"type":"A"},{"name":"PIT2","description":"Old descr","length":120,"mandatory":false,"type":"A"},{"name":"PITO","description":"Old name","length":60,"mandatory":false,"type":"A"},{"name":"PUPO","description":"Old price","length":17,"mandatory":false,"type":"N"},{"name":"DWDO","description":"Old deliv date","length":8,"mandatory":false,"type":"N"},{"name":"TELO","description":"Old text","length":36,"mandatory":false,"type":"A"},{"name":"CRUD","description":"CRUD Action","length":3,"mandatory":true,"type":"A"}],"utilities":[]}},"batches":{},"advancedPrograms":{}}},"utilities":{},"sources":{"60cf27fe-1782-47ed-aa6a-06bbb37b9702":{"uuid":"60cf27fe-1782-47ed-aa6a-06bbb37b9702","updated":1714622370626,"updatedBy":"RMURRAY","created":1709791720762,"createdBy":"RMURRAY","apiVersion":"0.9","beVersion":"16.0.0.20240221054708.9","language":"GROOVY","codeHash":"878A8D8DF4A9E4442ACE82078FCD4B72E1F024FF1D5712175316E42E1E0AA264","code":"LyoKICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgTk9USUNFICAgICAgICAgICAgICAgICAgICAgICAgICAgICoKICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgogKiAgIFRISVMgU09GVFdBUkUgSVMgVEhFIFBST1BFUlRZIE9GIEFORCBDT05UQUlOUyAgICAgICAgICAgICAqCiAqICAgQ09ORklERU5USUFMIElORk9STUFUSU9OIE9GIElORk9SIEFORC9PUiBJVFMgQUZGSUxJQVRFUyAgICoKICogICBPUiBTVUJTSURJQVJJRVMgQU5EIFNIQUxMIE5PVCBCRSBESVNDTE9TRUQgV0lUSE9VVCBQUklPUiAgKgogKiAgIFdSSVRURU4gUEVSTUlTU0lPTi4gTElDRU5TRUQgQ1VTVE9NRVJTIE1BWSBDT1BZIEFORCAgICAgICAqCiAqICAgQURBUFQgVEhJUyBTT0ZUV0FSRSBGT1IgVEhFSVIgT1dOIFVTRSBJTiBBQ0NPUkRBTkNFIFdJVEggICoKICogICBUSEUgVEVSTVMgT0YgVEhFSVIgU09GVFdBUkUgTElDRU5TRSBBR1JFRU1FTlQuICAgICAgICAgICAgKgogKiAgIEFMTCBPVEhFUiBSSUdIVFMgUkVTRVJWRUQuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoKICogICAoYykgQ09QWVJJR0hUIDIwMjAgSU5GT1IuICBBTEwgUklHSFRTIFJFU0VSVkVELiAgICAgICAgICAgKgogKiAgIFRIRSBXT1JEIEFORCBERVNJR04gTUFSS1MgU0VUIEZPUlRIIEhFUkVJTiBBUkUgICAgICAgICAgICAqCiAqICAgVFJBREVNQVJLUyBBTkQvT1IgUkVHSVNURVJFRCBUUkFERU1BUktTIE9GIElORk9SICAgICAgICAgICoKICogICBBTkQvT1IgSVRTIEFGRklMSUFURVMgQU5EIFNVQlNJRElBUklFUy4gQUxMIFJJR0hUUyAgICAgICAgKgogKiAgIFJFU0VSVkVELiAgQUxMIE9USEVSIFRSQURFTUFSS1MgTElTVEVEIEhFUkVJTiBBUkUgICAgICAgICAqCiAqICAgVEhFIFBST1BFUlRZIE9GIFRIRUlSIFJFU1BFQ1RJVkUgT1dORVJTLiAgICAgICAgICAgICAgICAgICoKICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgogKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCiovCiAKaW1wb3J0IGdyb292eS5sYW5nLkNsb3N1cmU7CmltcG9ydCBncm9vdnkuanNvbi5Kc29uU2x1cnBlcjsKCmltcG9ydCBqYXZhLnRpbWUuTG9jYWxEYXRlOwppbXBvcnQgamF2YS50aW1lLkxvY2FsRGF0ZVRpbWU7CmltcG9ydCBqYXZhLnRpbWUuZm9ybWF0LkRhdGVUaW1lRm9ybWF0dGVyOwppbXBvcnQgamF2YS50aW1lLmZvcm1hdC5EYXRlVGltZVBhcnNlRXhjZXB0aW9uCmltcG9ydCBqYXZhLmxhbmcuTnVtYmVyRm9ybWF0RXhjZXB0aW9uOwppbXBvcnQgamF2YS50aW1lLlpvbmVJZDsKCi8qCipNb2RpZmljYXRpb24gYXJlYSAtIE0zCipOYnIgICAgICAgICAgICAgICBEYXRlICAgICAgVXNlciBpZCAgICAgRGVzY3JpcHRpb24KKkVYVDEwMiAgICAgICAgICAgIDIwMjQwMTE2ICBSTVVSUkFZICAgICBVcGRhdGUgRVhUIGFwaSB0byBoYW5kbGUgcG9ydGFsIHVwZGF0ZXMgYW5kIGxvZ2dpbmcKKkVYVDEwMiAgICAgICAgICAgIDIwMjQwMjA1ICBSTVVSUkFZICAgICBWYWxpZGF0aW9uIG9uIElPTiBBUEkgY2FsbC4gCipFWFQxMDIgICAgICAgICAgICAyMDI0MDQxNCAgUk1VUlJBWSAgICAgQWRkIGluIFBPIExpbmUgY29uZmlybWF0aW9uCipFWFQxMDIgICAgICAgICAgICAyMDI0MDUwMSAgUk1VUlJBWSAgICAgUHJlcGFyZSBmb3Igc3VibWlzc2lvbiwgUFJEIEFwcHJvdmFsLgoqLwoKLyoKKiBVcGRQT0xpbmUKKi8KcHVibGljIGNsYXNzIFVwZFBPTGluZSBleHRlbmRzIEV4dGVuZE0zVHJhbnNhY3Rpb24gewoKCXByaXZhdGUgZmluYWwgTUlBUEkgbWk7Cglwcml2YXRlIGZpbmFsIERhdGFiYXNlQVBJIGRhdGFiYXNlOwoJcHJpdmF0ZSBmaW5hbCBMb2dnZXJBUEkgbG9nZ2VyOwoJcHJpdmF0ZSBmaW5hbCBQcm9ncmFtQVBJIHByb2dyYW07Cglwcml2YXRlIGZpbmFsIElvbkFQSSBpb247CgoJcHJpdmF0ZSBTdHJpbmcgcHVubzsKCXByaXZhdGUgU3RyaW5nIHBubGk7Cglwcml2YXRlIFN0cmluZyBwbmxzOwoJcHJpdmF0ZSBTdHJpbmcgcHVwcjsKCXByaXZhdGUgU3RyaW5nIGR3ZHQ7Cglwcml2YXRlIFN0cmluZyBwaXRkOwoJcHJpdmF0ZSBTdHJpbmcgcGl0dDsKCXByaXZhdGUgU3RyaW5nIHRlbDE7Cglwcml2YXRlIFN0cmluZyBlbWFsOwoJcHJpdmF0ZSBTdHJpbmcgc3VubzsKCXByaXZhdGUgU3RyaW5nIGl0bm87Cglwcml2YXRlIFN0cmluZyBvcnFhOwoJcHJpdmF0ZSBTdHJpbmcgY3J1ZDsKCXByaXZhdGUgU3RyaW5nIHB1cHJPbGQ7Cglwcml2YXRlIFN0cmluZyBkd2R0T2xkOwoJcHJpdmF0ZSBTdHJpbmcgcGl0ZE9sZDsKCXByaXZhdGUgU3RyaW5nIHBpdHRPbGQ7Cglwcml2YXRlIFN0cmluZyB0ZWwxT2xkOwoJcHJpdmF0ZSBTdHJpbmcgb3JxYU9sZDsKCXByaXZhdGUgU3RyaW5nIGN1cnJlbnREYXRlVGltZTsKCglwcml2YXRlIGxvbmcgcHVub0xvbmc7CgoJcHJpdmF0ZSBpbnQgY3VycmVudERhdGU7Cglwcml2YXRlIGludCBjdXJyZW50VGltZTsKCXByaXZhdGUgaW50IFhYQ09OTzsKCglwcml2YXRlIGJvb2xlYW4gaXNEYXRlUGFyc2VkOwoKCXB1YmxpYyBVcGRQT0xpbmUoTUlBUEkgbWksIERhdGFiYXNlQVBJIGRhdGFiYXNlLCBMb2dnZXJBUEkgbG9nZ2VyLCBQcm9ncmFtQVBJIHByb2dyYW0sIElvbkFQSSBpb24pIHsKCQl0aGlzLm1pID0gbWk7CgkJdGhpcy5kYXRhYmFzZSA9IGRhdGFiYXNlOwoJCXRoaXMubG9nZ2VyID0gbG9nZ2VyOwoJCXRoaXMucHJvZ3JhbSA9IHByb2dyYW07CgkJdGhpcy5pb24gPSBpb247IAoJfQoKCXB1YmxpYyB2b2lkIG1haW4oKSB7CgkJLyoqCiAgICAqRmV0Y2ggaW5wdXQgZmllbGRzIGZyb20gTUkKICAgICovCgkJcHVubyA9IG1pLmluRGF0YS5nZXQoIlBVTk8iKSA9PSBudWxsID8gJycgOiBtaS5pbkRhdGEuZ2V0KCJQVU5PIikudHJpbSgpOwoJCWlmIChwdW5vID09ICI/IikgewoJCQlwdW5vID0gIiI7CgkJfSAKCQlwbmxpID0gbWkuaW5EYXRhLmdldCgiUE5MSSIpID09IG51bGwgPyAnJyA6IG1pLmluRGF0YS5nZXQoIlBOTEkiKS50cmltKCk7CgkJaWYgKHBubGkgPT0gIj8iKSB7CgkJCXBubGkgPSAiIjsKCQl9IAoJCXBubHMgPSBtaS5pbkRhdGEuZ2V0KCJQTkxTIikgPT0gbnVsbCA/ICcnIDogbWkuaW5EYXRhLmdldCgiUE5MUyIpLnRyaW0oKTsKCQlpZiAocG5scyA9PSAiPyIpIHsKCQkJcG5scyA9ICIiOwoJCX0gCgkJdGVsMSA9IG1pLmluRGF0YS5nZXQoIlRFTDEiKSA9PSBudWxsID8gJycgOiBtaS5pbkRhdGEuZ2V0KCJURUwxIikudHJpbSgpOwoJCWlmICh0ZWwxID09ICI/IikgewoJCQl0ZWwxID0gIiI7CgkJfSAKCQlwaXRkID0gbWkuaW5EYXRhLmdldCgiUElURCIpID09IG51bGwgPyAnJyA6IG1pLmluRGF0YS5nZXQoIlBJVEQiKS50cmltKCk7CgkJaWYgKHBpdGQgPT0gIj8iKSB7CgkJCXBpdGQgPSAiIjsKCQl9IAoJCXBpdHQgPSBtaS5pbkRhdGEuZ2V0KCJQSVRUIikgPT0gbnVsbCA/ICcnIDogbWkuaW5EYXRhLmdldCgiUElUVCIpLnRyaW0oKTsKCQlpZiAocGl0dCA9PSAiPyIpIHsKCQkJcGl0dCA9ICIiOwoJCX0gCgkJcHVwciA9IG1pLmluRGF0YS5nZXQoIlBVUFIiKSA9PSBudWxsID8gJycgOiBtaS5pbkRhdGEuZ2V0KCJQVVBSIikudHJpbSgpOwoJCWlmIChwdXByID09ICI/IikgewoJCQlwdXByID0gIiI7CgkJfSAgICAgCgkJZHdkdCA9IG1pLmluRGF0YS5nZXQoIkRXRFQiKSA9PSBudWxsID8gJycgOiBtaS5pbkRhdGEuZ2V0KCJEV0RUIikudHJpbSgpOwoJCWlmIChkd2R0ID09ICI/IikgewoJCQlkd2R0ID0gIiI7CgkJfSAKCQl0ZWwxID0gbWkuaW5EYXRhLmdldCgiVEVMMSIpID09IG51bGwgPyAnJyA6IG1pLmluRGF0YS5nZXQoIlRFTDEiKS50cmltKCk7CgkJaWYgKHRlbDEgPT0gIj8iKSB7CgkJCXRlbDEgPSAiIjsKCQl9IAoJCWVtYWwgPSBtaS5pbkRhdGEuZ2V0KCJFTUFMIikgPT0gbnVsbCA/ICcnIDogbWkuaW5EYXRhLmdldCgiRU1BTCIpLnRyaW0oKTsKCQlpZiAoZW1hbCA9PSAiPyIpIHsKCQkJZW1hbCA9ICIiOwoJCX0gCgkJcGl0dE9sZCA9IG1pLmluRGF0YS5nZXQoIlBJVDIiKSA9PSBudWxsID8gJycgOiBtaS5pbkRhdGEuZ2V0KCJQSVQyIikudHJpbSgpOwoJCWlmIChwaXR0T2xkID09ICI/IikgewoJCQlwaXR0T2xkID0gIiI7CgkJfSAKCQlwaXRkT2xkID0gbWkuaW5EYXRhLmdldCgiUElUTyIpID09IG51bGwgPyAnJyA6IG1pLmluRGF0YS5nZXQoIlBJVE8iKS50cmltKCk7CgkJaWYgKHBpdGRPbGQgPT0gIj8iKSB7CgkJCXBpdGRPbGQgPSAiIjsKCQl9IAoJCXB1cHJPbGQgPSBtaS5pbkRhdGEuZ2V0KCJQVVBPIikgPT0gbnVsbCA/ICcnIDogbWkuaW5EYXRhLmdldCgiUFVQTyIpLnRyaW0oKTsKCQlpZiAocHVwck9sZCA9PSAiPyIpIHsKCQkJcHVwck9sZCA9ICIiOwoJCX0gICAgIAoJCWR3ZHRPbGQgPSBtaS5pbkRhdGEuZ2V0KCJEV0RPIikgPT0gbnVsbCA/ICcnIDogbWkuaW5EYXRhLmdldCgiRFdETyIpLnRyaW0oKTsKCQlpZiAoZHdkdE9sZCA9PSAiPyIpIHsKCQkJZHdkdE9sZCA9ICIiOwoJCX0gCgkJdGVsMU9sZCA9IG1pLmluRGF0YS5nZXQoIlRFTE8iKSA9PSBudWxsID8gJycgOiBtaS5pbkRhdGEuZ2V0KCJURUxPIikudHJpbSgpOwoJCWlmICh0ZWwxT2xkID09ICI/IikgewoJCQl0ZWwxT2xkID0gIiI7CgkJfSAKCQljcnVkID0gbWkuaW5EYXRhLmdldCgiQ1JVRCIpID09IG51bGwgPyAnJyA6IG1pLmluRGF0YS5nZXQoIkNSVUQiKS50cmltKCk7CgkJaWYgKGNydWQgPT0gIj8iKSB7CgkJCWNydWQgPSAiIjsKCQl9IAoJCXN1bm8gPSAiIjsKCQlpdG5vID0gIiI7CgkJb3JxYSA9ICIiOwoJCW9ycWFPbGQgPSAiIjsKCgkJLyoKICAgICogUGVyZm9ybSB2YWxpZGF0aW9uIG9uIGlucHV0IHZhcmlhYmxlcwogICAgKi8KCQlpZiAoIXZhbGlkYXRlSW5wdXQoKSkgewoJCQlyZXR1cm47CgkJfQoKCQkvKgogICAgKiBTZXQgRGF0ZSBWYXJpYWJsZXMgd2l0aCBjdXN0b21lciBsb2NhbCB0aW1lIHpvbmUKICAgICovCgkJWm9uZUlkIHppZCA9IFpvbmVJZC5vZigiQXVzdHJhbGlhL0JyaXNiYW5lIik7IAoJCWN1cnJlbnREYXRlID0gTG9jYWxEYXRlLm5vdyh6aWQpLmZvcm1hdChEYXRlVGltZUZvcm1hdHRlci5vZlBhdHRlcm4oInl5eXlNTWRkIikpLnRvSW50ZWdlcigpOwoJCWN1cnJlbnRUaW1lID0gSW50ZWdlci52YWx1ZU9mKExvY2FsRGF0ZVRpbWUubm93KCkuZm9ybWF0KERhdGVUaW1lRm9ybWF0dGVyLm9mUGF0dGVybigiSEhtbXNzIikpKTsKCQljdXJyZW50RGF0ZVRpbWUgPSAgKExvY2FsRGF0ZS5ub3coemlkKS5mb3JtYXQoRGF0ZVRpbWVGb3JtYXR0ZXIub2ZQYXR0ZXJuKCJkZCBNTU0geXl5eSIpKSArICIgIiArIExvY2FsRGF0ZVRpbWUubm93KCkuZm9ybWF0KERhdGVUaW1lRm9ybWF0dGVyLm9mUGF0dGVybigiSEg6bW06c3MiKSkpLnRvU3RyaW5nKCkgKyAiIEFFU1QiOyAKCiAgICAvKgogICAgKiBSZXRyaWV2ZSBwdXJjaGFzZSBvcmRlciBsaW5lIGluZm9ybWF0aW9uIHZpYSBBUEkgUFBTMjAwTUlfR2V0TGluZQogICAgKi8KICAgIE1hcDxTdHJpbmcsIFN0cmluZz4gcGFyYW1zUE9MaW5lID0gWyAiQ09OTyI6IFhYQ09OTy50b1N0cmluZygpLCAiUFVOTyI6IHB1bm8sICJQTkxJIjogcG5saSwgIlBOTFMiOiBwbmxzIF07CgkJU3RyaW5nIHVybFBPTGluZSA9ICIvTTMvbTNhcGktcmVzdC92Mi9leGVjdXRlL1BQUzIwME1JL0dldExpbmUiOwoJCgkJTWFwPFN0cmluZyxTdHJpbmc+IGhlYWRlcnNQT0xpbmUgPSBbIkFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uIl07CgkJSW9uUmVzcG9uc2UgcmVzcG9uc2VQT0xpbmUgPSBpb24uZ2V0KHVybFBPTGluZSwgaGVhZGVyc1BPTGluZSwgcGFyYW1zUE9MaW5lKTsKCiAgICBpZihyZXNwb25zZVBPTGluZS5nZXRFcnJvcigpKXsKICAgICAgbG9nZ2VyLmRlYnVnKCJGYWlsZWQgY2FsbGluZyBJT04gQVBJICR7dXJsUE9MaW5lfSwgZGV0YWlsZWQgZXJyb3IgbWVzc2FnZTogJHtyZXNwb25zZVBPTGluZS5nZXRFcnJvck1lc3NhZ2UoKX0iKTsKICAgICAgbWkuZXJyb3IoImNhbGxpbmcgYXBpIGZhaWxlZCAke3VybFBPTGluZX0gIiArIHJlc3BvbnNlUE9MaW5lLmdldEVycm9yTWVzc2FnZSgpKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIC8qCiAgICAqIElmIHBheWxvYWQgaXMgZm9yIFBPIENvbmZpcm1hdGlvbiAiQ05GIgogICAgKi8KCQlpZihjcnVkID09ICJDTkYiKXsKCgkJCWlmIChyZXNwb25zZVBPTGluZS5nZXRTdGF0dXNDb2RlKCkgPT0gMjAwKSB7CgkJCQlKc29uU2x1cnBlciBqc29uU2x1cnBlciA9IG5ldyBKc29uU2x1cnBlcigpOwoJCQkJTWFwPFN0cmluZywgT2JqZWN0PiBtaVJlc3BvbnNlID0gKE1hcDxTdHJpbmcsIE9iamVjdD4pIGpzb25TbHVycGVyLnBhcnNlVGV4dChyZXNwb25zZVBPTGluZS5nZXRDb250ZW50KCkpOwoJCQkJQXJyYXlMaXN0PE1hcDxTdHJpbmcsIE9iamVjdD4+IHJlc3VsdHMgPSAoQXJyYXlMaXN0PE1hcDxTdHJpbmcsIE9iamVjdD4+KSBtaVJlc3BvbnNlLmdldCgicmVzdWx0cyIpOwoJCQkJQXJyYXlMaXN0PE1hcDxTdHJpbmcsIFN0cmluZz4+IHJlY29yZExpc3QgPSAoQXJyYXlMaXN0PE1hcDxTdHJpbmcsIFN0cmluZz4+KSByZXN1bHRzWzBdWyJyZWNvcmRzIl07CgkJCQlyZWNvcmRMaXN0LmVhY2hXaXRoSW5kZXggeyBpdCwgaW5kZXggLT4KCQkJCQlNYXA8U3RyaW5nLCBTdHJpbmc+IHJlY29yZE1QTElORSA9IChNYXA8U3RyaW5nLCBTdHJpbmc+KSBpdDsKCQkJCQlpZiAocmVjb3JkTVBMSU5FLlNVTk8gIT0gbnVsbCkgewoJCQkJCQlpdG5vID0gcmVjb3JkTVBMSU5FLklUTk87CgkJCQkJCXN1bm8gPSByZWNvcmRNUExJTkUuU1VOTzsKCQkJCQkJb3JxYU9sZCA9IHJlY29yZE1QTElORS5PUlFBOwoJCQkJCQlvcnFhID0gcmVjb3JkTVBMSU5FLk9SUUE7CgkJCQkJCWlmKCFpc1N0cmluZ051bGxPckVtcHR5KHB1cHIpICYmIGlzU3RyaW5nTnVsbE9yRW1wdHkocHVwck9sZCkpewoJCQkJCQkJcHVwck9sZCA9IHJlY29yZE1QTElORS5QVVBSOyAgCgkJCQkJCX0KCQkJCQkJaWYoIWlzU3RyaW5nTnVsbE9yRW1wdHkoZHdkdCkgJiYgaXNTdHJpbmdOdWxsT3JFbXB0eShkd2R0T2xkKSl7CgkJCQkJCQlkd2R0T2xkID0gcmVjb3JkTVBMSU5FLkRXRFQ7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJCX0KCiAgICAgIC8qCiAgICAgICogUGVyZm9ybSBQTyBMaW5lIENvbmZpcm1hdGlvbiB2aWEgQVBJIFBQUzEwME1JX0NvbmZpcm1MaW5lCiAgICAgICovCgkJCU1hcDxTdHJpbmcsIFN0cmluZz4gcGFyYW1zID0gbmV3IEhhc2hNYXA8U3RyaW5nLFN0cmluZz4oKTsKCQkJU3RyaW5nIHVybENvbmZpcm1MaW5lID0gIi9NMy9tM2FwaS1yZXN0L3YyL2V4ZWN1dGUvUFBTMDAxTUkvQ29uZmlybUxpbmUiOwoJCQlwYXJhbXMgPSBbICJQVU5PIjogcHVubywgICJQTkxJIjogcG5saSwgIlBOTFMiOiBwbmxzIF07CgkJCWlmKCFpc1N0cmluZ051bGxPckVtcHR5KHB1cHIpKXsKCQkJCXBhcmFtcy5wdXQoIlBVUFIiLCBwdXByKTsKCQkJfQoJCQlpZighaXNTdHJpbmdOdWxsT3JFbXB0eShkd2R0KSl7CgkJCQlwYXJhbXMucHV0KCJEV0RUIiwgZHdkdCk7CgkJCX0KCQkJTWFwPFN0cmluZyxTdHJpbmc+IGhlYWRlcnMgPSBbIkFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uIl07CgkJCUlvblJlc3BvbnNlIHJlc3BvbnNlID0gaW9uLmdldCh1cmxDb25maXJtTGluZSwgaGVhZGVycywgcGFyYW1zKTsKCQkJaWYocmVzcG9uc2UuZ2V0RXJyb3IoKSl7CgkJCQlsb2dnZXIuZGVidWcoIkZhaWxlZCBjYWxsaW5nIElPTiBBUEkgJHt1cmxDb25maXJtTGluZX0sIGRldGFpbGVkIGVycm9yIG1lc3NhZ2U6ICR7cmVzcG9uc2UuZ2V0RXJyb3JNZXNzYWdlKCl9Iik7CgkJCQltaS5lcnJvcigiY2FsbGluZyBhcGkgZmFpbGVkICR7dXJsQ29uZmlybUxpbmV9ICIgKyByZXNwb25zZS5nZXRFcnJvck1lc3NhZ2UoKSk7CgkJCQlyZXR1cm47CgkJCX0KICAgICAgCiAgICB9IGVsc2UgewogICAgICAvKgogICAgICAqIElmIHBheWxvYWQgaXMgbm90IGZvciBQTyBMaW5lIENvbmZpcm1hdGlvbiwgQXNzdW1lZCBhcyBhIFBPIExpbmUgVXBkYXRlLgogICAgICAqLwoJCQlpZiAocmVzcG9uc2VQT0xpbmUuZ2V0U3RhdHVzQ29kZSgpID09IDIwMCkgewoJCQkJSnNvblNsdXJwZXIganNvblNsdXJwZXIgPSBuZXcgSnNvblNsdXJwZXIoKTsKCQkJCU1hcDxTdHJpbmcsIE9iamVjdD4gbWlSZXNwb25zZSA9IChNYXA8U3RyaW5nLCBPYmplY3Q+KSBqc29uU2x1cnBlci5wYXJzZVRleHQocmVzcG9uc2VQT0xpbmUuZ2V0Q29udGVudCgpKTsKCQkJCUFycmF5TGlzdDxNYXA8U3RyaW5nLCBPYmplY3Q+PiByZXN1bHRzID0gKEFycmF5TGlzdDxNYXA8U3RyaW5nLCBPYmplY3Q+PikgbWlSZXNwb25zZS5nZXQoInJlc3VsdHMiKTsKCQkJCUFycmF5TGlzdDxNYXA8U3RyaW5nLCBTdHJpbmc+PiByZWNvcmRMaXN0ID0gKEFycmF5TGlzdDxNYXA8U3RyaW5nLCBTdHJpbmc+PikgcmVzdWx0c1swXVsicmVjb3JkcyJdOwoJCQkJcmVjb3JkTGlzdC5lYWNoV2l0aEluZGV4IHsgaXQsIGluZGV4IC0+CgkJCQkJTWFwPFN0cmluZywgU3RyaW5nPiByZWNvcmRNUExJTkUgPSAoTWFwPFN0cmluZywgU3RyaW5nPikgaXQ7CgkJCQkJaWYgKHJlY29yZE1QTElORS5TVU5PICE9IG51bGwpIHsKCQkJCQkJaXRubyA9IHJlY29yZE1QTElORS5JVE5POwoJCQkJCQlzdW5vID0gcmVjb3JkTVBMSU5FLlNVTk87CgkJCQkJCW9ycWFPbGQgPSByZWNvcmRNUExJTkUuT1JRQTsKCQkJCQkJb3JxYSA9IHJlY29yZE1QTElORS5PUlFBOwoJCQkJCQlpZihpc1N0cmluZ051bGxPckVtcHR5KHB1cHJPbGQpKXsKCQkJCQkJCXB1cHJPbGQgPSByZWNvcmRNUExJTkUuUFVQUjsgIAoJCQkJCQl9CgkJCQkJCWlmKGlzU3RyaW5nTnVsbE9yRW1wdHkodGVsMU9sZCkpewoJCQkJCQkJdGVsMU9sZCA9IHJlY29yZE1QTElORS5URUwxOyAgCgkJCQkJCX0KCQkJCQkJaWYoaXNTdHJpbmdOdWxsT3JFbXB0eShwaXRkT2xkKSl7CgkJCQkJCQlwaXRkT2xkID0gcmVjb3JkTVBMSU5FLlBJVEQ7CgkJCQkJCX0KCQkJCQkJaWYoaXNTdHJpbmdOdWxsT3JFbXB0eShwaXR0T2xkKSl7CgkJCQkJCQlwaXR0T2xkID0gcmVjb3JkTVBMSU5FLlBJVFQ7CgkJCQkJCX0KCQkJCQkJaWYoaXNTdHJpbmdOdWxsT3JFbXB0eShkd2R0T2xkKSl7CgkJCQkJCQlkd2R0T2xkID0gcmVjb3JkTVBMSU5FLkRXRFQ7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJCX0KICAJICAKICAgICAgLyoKICAgICAgKiBQZXJmb3JtIFVwZGF0ZSBvbiBQTyBMaW5lIHZpYSBBUEkgUFBTMjAwTUlfVXBkTGluZQogICAgICAqLwoJCQlNYXA8U3RyaW5nLCBTdHJpbmc+IHBhcmFtcyA9IG5ldyBIYXNoTWFwPFN0cmluZyxTdHJpbmc+KCk7CgkJCVN0cmluZyB1cmxVcGRMaW5lID0gIi9NMy9tM2FwaS1yZXN0L3YyL2V4ZWN1dGUvUFBTMjAwTUkvVXBkTGluZSI7CgkJCXBhcmFtcyA9IFsgIlBVTk8iOiBwdW5vLCAgIlBOTEkiOiBwbmxpLCAiUE5MUyI6IHBubHMgXTsKCQkJaWYoIWlzU3RyaW5nTnVsbE9yRW1wdHkocHVwcikpewoJCQkJcGFyYW1zLnB1dCgiUFVQUiIsIHB1cHIpOwoJCQl9CgkJCWlmKCFpc1N0cmluZ051bGxPckVtcHR5KGR3ZHQpKXsKCQkJCXBhcmFtcy5wdXQoIkRXRFQiLCBkd2R0KTsKCQkJfQoJCQlpZighaXNTdHJpbmdOdWxsT3JFbXB0eShwaXRkKSl7CgkJCQlwYXJhbXMucHV0KCJQSVREIiwgcGl0ZCk7CgkJCX0KCQkJaWYoIWlzU3RyaW5nTnVsbE9yRW1wdHkocGl0dCkpewoJCQkJcGFyYW1zLnB1dCgiUElUVCIsIHBpdHQpOwoJCQl9CgkJCWlmKCFpc1N0cmluZ051bGxPckVtcHR5KHRlbDEpKXsKCQkJCXBhcmFtcy5wdXQoIlRFTDEiLCB0ZWwxKTsKCQkJfQoJCQlNYXA8U3RyaW5nLFN0cmluZz4gaGVhZGVycyA9IFsiQWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24iXTsKCQkJSW9uUmVzcG9uc2UgcmVzcG9uc2UgPSBpb24uZ2V0KHVybFVwZExpbmUsIGhlYWRlcnMsIHBhcmFtcyk7CgkJCWlmKHJlc3BvbnNlLmdldEVycm9yKCkpewoJCQkJbG9nZ2VyLmRlYnVnKCJGYWlsZWQgY2FsbGluZyBJT04gQVBJICR7dXJsVXBkTGluZX0sIGRldGFpbGVkIGVycm9yIG1lc3NhZ2U6ICR7cmVzcG9uc2UuZ2V0RXJyb3JNZXNzYWdlKCl9Iik7CgkJCQltaS5lcnJvcigiY2FsbGluZyBhcGkgZmFpbGVkICR7dXJsVXBkTGluZX0gIiArIHJlc3BvbnNlLmdldEVycm9yTWVzc2FnZSgpKTsKCQkJCXJldHVybjsKCQkJfQoKCQl9CgogICAgLyoKICAgICogV3JpdGUgbG9nIHZhbHVlcyB0byBleHRlbnNpb24gdGFibGUgRVhUU1BaCiAgICAqLwoJCXdyaXRlRVhUKCkKCX0KCgkvKgoJKiB2YWxpZGF0ZUlucHV0IC0gVmFsaWRhdGUgYWxsIHRoZSBpbnB1dCBmaWVsZHMKCSogQHJldHVybiBmYWxzZSBpZiB0aGVyZSBpcyBhbnkgZXJyb3IKCSogICAgICAgICB0cnVlIGlmIHBhc3MgdGhlIHZhbGlkYXRpb24KCSovCglwcml2YXRlIGJvb2xlYW4gdmFsaWRhdGVJbnB1dCgpewoKICAgIC8qCiAgICAqIFNldCBjb21wYW55IG51bWJlcgogICAgKi8KCQlYWENPTk89IHByb2dyYW0uTERBWkQuQ09OTzsKCiAgICAvKgogICAgKiBDUlVEIGZpZWxkIG11c3Qgbm90IGJlIG51bGwgb3IgZW1wdHkKICAgICovCgkJaWYoaXNTdHJpbmdOdWxsT3JFbXB0eShjcnVkKSl7CgkJCWxvZ2dlci5kZWJ1ZygibWkuZXJyb3I6IENSVUQgdmFsdWUgaXMgbnVsbCBvciBlbXB0eSIpOwoJCQltaS5lcnJvcigiQ3J1ZCB2YWx1ZSBub3Qgc3BlY2lmaWVkIikKCQkJcmV0dXJuIGZhbHNlOwoJCX0gCgogICAgLyoKICAgICogQ1JVRCBtdXN0IGJlIFVQRCBvciBDTkYKICAgICovCgkJaWYoY3J1ZCAhPSAiVVBEIiAmJiBjcnVkICE9ICJDTkYiKXsKCQkJbG9nZ2VyLmRlYnVnKCJtaS5lcnJvcjogQ1JVRCBpbnB1dCBpcyBpbmNvcnJlY3QgIiArIGNydWQpOwoJCQltaS5lcnJvcigiQ1JVRCBtdXN0IGJlIFVQRCBvciBDTkYiKTsKCQkJcmV0dXJuIGZhbHNlOwoJCX0KCiAgICAvKgogICAgKiBWYWxpZGF0ZSBrZXkgZmllbGRzIHVzZWQgZm9yIGFwaSBjYWxsCiAgICAqLwoJCVN0cmluZyBwdXJjaGFzZU9yZGVyTGluZSA9IGlzU3RyaW5nTnVsbE9yRW1wdHkocHVubykgPyAiUFVOTyIgOiBpc1N0cmluZ051bGxPckVtcHR5KHBubGkpID8gIlBOTEkiIDogaXNTdHJpbmdOdWxsT3JFbXB0eShwbmxzKSA/ICJQTkxTIiA6ICIiOwoJCWlmICghaXNTdHJpbmdOdWxsT3JFbXB0eShwdXJjaGFzZU9yZGVyTGluZSkpIHsKCQkJbWkuZXJyb3IoIiR7cHVyY2hhc2VPcmRlckxpbmV9LCBub3QgZGVmaW5lZCIpOwoJCQlyZXR1cm4gZmFsc2U7CgkJfQoKICAgIC8qCiAgICAqIFBhcnNlIFBVTk8gdG8gTG9uZyBwdW5vTG9uZwogICAgKi8KCQlwdW5vTG9uZyA9IHRyeVBhcnNlTG9uZyhwdW5vKTsKCiAgICAvKgogICAgKiBWYWxpZGF0ZSBkd2R0IGFzIGRhdGUgTW92ZXhEYXRlCiAgICAqLwoJCWlzRGF0ZVBhcnNlZCA9IHRyeVBhcnNlRGF0ZShkd2R0KTsKCQlpZihpc1N0cmluZ051bGxPckVtcHR5KGR3ZHQpKXsKCQkJaXNEYXRlUGFyc2VkID0gdHJ5UGFyc2VEYXRlKGR3ZHRPbGQpOwoJCX0KCQlpZighaXNEYXRlUGFyc2VkKXsKCQkJcmV0dXJuIGZhbHNlOwoJCX0KCiAgICAvKgogICAgKiBWYWxpZGF0ZSB1c2VyIGVtYWlsIG5vdCBlbXB0eQogICAgKi8KCQlpZihpc1N0cmluZ051bGxPckVtcHR5KGVtYWwpKXsKCQkJbWkuZXJyb3IoIkVNQUwgbm90IHN1cHBsaWVkIik7CgkJCXJldHVybiBmYWxzZTsKCQl9CgoJCS8qCiAgICAqIFZhbGlkYXRpb24gU3VjY2Vzc2Z1bAogICAgKi8KCQlyZXR1cm4gdHJ1ZTsKCX0KCiAgLyoKCSogd3JpdGVFWFQKCSogQ3JlYXRlIGxvZyBlbnRyeSBpbiB0YWJsZSBFWFRTUFoKCSovCiAgcHJpdmF0ZSB2b2lkIHdyaXRlRVhUKCkgewoJCURCQWN0aW9uIGFjdGlvbkVYVFNQWiA9IGRhdGFiYXNlLnRhYmxlKCJFWFRTUFoiKS5idWlsZCgpOwoJCURCQ29udGFpbmVyIEVYVFNQWiA9IGFjdGlvbkVYVFNQWi5nZXRDb250YWluZXIoKTsKCQlFWFRTUFouc2V0KCJFWENPTk8iLCBYWENPTk8pOwoJCUVYVFNQWi5zZXQoIkVYU1VOTyIsIHN1bm8pOwoJCUVYVFNQWi5zZXQoIkVYSVROTyIsIGl0bm8pOwoJCUVYVFNQWi5zZXQoIkVYUFVOTyIsIHB1bm9Mb25nKTsKCQlFWFRTUFouc2V0KCJFWFBOTEkiLCBwbmxpLnRvSW50ZWdlcigpKTsKCQlFWFRTUFouc2V0KCJFWFBOTFMiLCBwbmxzLnRvSW50ZWdlcigpKTsKCQlFWFRTUFouc2V0KCJFWE9SUUEiLCBvcnFhLnRvRG91YmxlKCkpOwoJCUVYVFNQWi5zZXQoIkVYT1JRTyIsIG9ycWFPbGQudG9Eb3VibGUoKSk7CgkJaWYoIWlzU3RyaW5nTnVsbE9yRW1wdHkocHVwcikpewoJCQlFWFRTUFouc2V0KCJFWFBVUFIiLCBwdXByLnRvRG91YmxlKCkpOwoJCQlpZighaXNTdHJpbmdOdWxsT3JFbXB0eShwdXByT2xkKSl7CgkJCQlFWFRTUFouc2V0KCJFWFBVUE8iLCBwdXByT2xkLnRvRG91YmxlKCkpOwoJCQl9CgkJfQoJCWlmKCFpc1N0cmluZ051bGxPckVtcHR5KGR3ZHQpKXsKCQkJRVhUU1BaLnNldCgiRVhEV0RUIiwgZHdkdC50b0ludGVnZXIoKSk7CgkJCWlmKCFpc1N0cmluZ051bGxPckVtcHR5KGR3ZHRPbGQpKXsgCgkJCQlFWFRTUFouc2V0KCJFWERXRE8iLCBkd2R0T2xkLnRvSW50ZWdlcigpKTsKCQkJfQoJCX0KCQlpZighaXNTdHJpbmdOdWxsT3JFbXB0eShwaXRkKSl7CgkJCUVYVFNQWi5zZXQoIkVYUElURCIsIHBpdGQpOwoJCQlpZihpc1N0cmluZ051bGxPckVtcHR5KHBpdGRPbGQpKXsKCQkJCUVYVFNQWi5zZXQoIkVYUElUTyIsIHBpdGRPbGQpOwoJCQl9CgkJfQoJCWlmKCFpc1N0cmluZ051bGxPckVtcHR5KHBpdHQpKXsKCQkJRVhUU1BaLnNldCgiRVhQSVRUIiwgcGl0dCk7CgkJCWlmKCFpc1N0cmluZ051bGxPckVtcHR5KHBpdHRPbGQpKXsKCQkJCUVYVFNQWi5zZXQoIkVYUElUMiIsIHBpdHRPbGQpOwoJCQl9CgkJfQoJCWlmKCFpc1N0cmluZ051bGxPckVtcHR5KHRlbDEpKXsKCQkJRVhUU1BaLnNldCgiRVhURUwxIiwgdGVsMSk7CgkJCWlmKCFpc1N0cmluZ051bGxPckVtcHR5KHRlbDFPbGQpKXsKCQkJCUVYVFNQWi5zZXQoIkVYVEVMTyIsIHRlbDFPbGQpOwoJCQl9CgkJfQoJCUVYVFNQWi5zZXQoIkVYRU1BTCIsIGVtYWwpOwoJCUVYVFNQWi5zZXQoIkVYTE1EVCIsIGN1cnJlbnREYXRlLnRvSW50ZWdlcigpKTsKCQlFWFRTUFouc2V0KCJFWExNVE0iLCBjdXJyZW50VGltZS50b0ludGVnZXIoKSk7CgkJRVhUU1BaLnNldCgiRVhEVFhYIiwgY3VycmVudERhdGVUaW1lKTsKCQlFWFRTUFouc2V0KCJFWENSVUQiLCBjcnVkKTsgCgkJYWN0aW9uRVhUU1BaLmluc2VydChFWFRTUFosIHJlY29yZEV4aXN0cyk7Cgl9CgkKCS8qCgkqIHJlY29yZEV4aXN0cyAtIHJldHVybiByZWNvcmQgYWxyZWFkeSBleGlzdHMgZXJyb3IgbWVzc2FnZSB0byB0aGUgTUkKCSovCglDbG9zdXJlIHJlY29yZEV4aXN0cyA9IHsKCQltaS5lcnJvcigiUmVjb3JkIGFscmVhZHkgZXhpc3RzIik7Cgl9CgogIC8qCiAgKiBIZWxwZXJzCiAgKi8KCXByaXZhdGUgTG9uZyB0cnlQYXJzZUxvbmcoU3RyaW5nIHN0cmluZ1RvUGFyc2UpewoJCWlmKGlzU3RyaW5nTnVsbE9yRW1wdHkoc3RyaW5nVG9QYXJzZSkpewoJCQltaS5lcnJvcigiUGFyc2UgTG9uZyBzdHJpbmcgaXMgRW1wdHkiKTsKCQkJcmV0dXJuIC0xOwoJCX0KCQl0cnkgewoJCQlyZXR1cm4gTG9uZy5wYXJzZUxvbmcoc3RyaW5nVG9QYXJzZSk7CgkJfSBjYXRjaCAoTnVtYmVyRm9ybWF0RXhjZXB0aW9uIG5mZSl7CgkJCW1pLmVycm9yKCJQYXJzZSBMb25nICIgKyBzdHJpbmdUb1BhcnNlLnRvU3RyaW5nKCkgKyAiICIgKyBuZmUuZ2V0TWVzc2FnZSgpKTsKCQkJcmV0dXJuIC0xOwoJCX0KCX0KCXByaXZhdGUgdm9pZCB0cnlQYXJzZURhdGUoU3RyaW5nIHN0cmluZ1RvUGFyc2UpewoJCWlmIChpc1N0cmluZ051bGxPckVtcHR5KHN0cmluZ1RvUGFyc2UpKSB7CgkJCWlmKHN0cmluZ1RvUGFyc2UubGVuZ3RoKCkgIT0gOCl7CgkJCQltaS5lcnJvcigiRGF0ZSBsZW5ndGggbXVzdCBiZSA4IC0gRFdEVCIpOwoJCQl9CgkJCXRyeSB7CgkJCQlMb2NhbERhdGUucGFyc2Uoc3RyaW5nVG9QYXJzZSwgRGF0ZVRpbWVGb3JtYXR0ZXIub2ZQYXR0ZXJuKCJ5eXl5TU1kZCIpKQoJCQl9IGNhdGNoIChEYXRlVGltZVBhcnNlRXhjZXB0aW9uIGUpIHsKCQkJCW1pLmVycm9yKCJJbmNvcnJlY3QgZGF0ZSBmb3JtYXQgeXl5eU1NZGQgLSBEV0RUIik7CgkJCX0KCQl9CgkJbWkuZXJyb3IoIkRhdGUgbGVuZ3RoIG11c3QgYmUgOCAtIERXRFQiKTsKCX0KCXByaXZhdGUgYm9vbGVhbiBpc1N0cmluZ051bGxPckVtcHR5KFN0cmluZyBzdHJpbmdUb1ZhbGlkYXRlKXsKCQlyZXR1cm4gc3RyaW5nVG9WYWxpZGF0ZSA9PSBudWxsIHx8IHN0cmluZ1RvVmFsaWRhdGUuaXNFbXB0eSgpOwoJfQoKfQo="}}}