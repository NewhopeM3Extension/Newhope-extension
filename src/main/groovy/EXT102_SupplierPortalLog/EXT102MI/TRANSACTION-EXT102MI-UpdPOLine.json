{"programModules":{"EXT102MI":{"program":"EXT102MI","triggers":{},"transactions":{"UpdPOLine":{"sourceUuid":"60cf27fe-1782-47ed-aa6a-06bbb37b9702","name":"UpdPOLine","program":"EXT102MI","description":"Upsert item supplier record, and log portal crud transaction","active":true,"multi":false,"modified":1714622250883,"modifiedBy":"RMURRAY","outputFields":[],"inputFields":[{"name":"PUNO","description":"purchase order number","length":10,"mandatory":true,"type":"A"},{"name":"PNLI","description":"purchase order line","length":6,"mandatory":true,"type":"A"},{"name":"PNLS","description":"purchase order line subnumber","length":3,"mandatory":true,"type":"A"},{"name":"PUPR","description":"purchase price","length":17,"mandatory":false,"type":"N"},{"name":"DWDT","description":"requested delivery date","length":8,"mandatory":false,"type":"N"},{"name":"PITD","description":"purchase order item name","length":60,"mandatory":false,"type":"A"},{"name":"PITT","description":"purchase order item description","length":120,"mandatory":false,"type":"A"},{"name":"TEL1","description":"terms text","length":36,"mandatory":false,"type":"A"},{"name":"EMAL","description":"portal user","length":100,"mandatory":false,"type":"A"},{"name":"PIT2","description":"Old descr","length":120,"mandatory":false,"type":"A"},{"name":"PITO","description":"Old name","length":60,"mandatory":false,"type":"A"},{"name":"PUPO","description":"Old price","length":17,"mandatory":false,"type":"N"},{"name":"DWDO","description":"Old deliv date","length":8,"mandatory":false,"type":"N"},{"name":"TELO","description":"Old text","length":36,"mandatory":false,"type":"A"},{"name":"CRUD","description":"CRUD Action","length":3,"mandatory":true,"type":"A"}],"utilities":[]}},"batches":{},"advancedPrograms":{}}},"utilities":{},"sources":{"60cf27fe-1782-47ed-aa6a-06bbb37b9702":{"uuid":"60cf27fe-1782-47ed-aa6a-06bbb37b9702","updated":1715133011980,"updatedBy":"RMURRAY","created":1709791720762,"createdBy":"RMURRAY","apiVersion":"0.9","beVersion":"16.0.0.20240221054708.9","language":"GROOVY","codeHash":"78F445FB84872D7F84085184B4A0FE00F843224FF59FDB87C470380553CAC3A8","code":"LyoKICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgTk9USUNFICAgICAgICAgICAgICAgICAgICAgICAgICAgICoKICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgogKiAgIFRISVMgU09GVFdBUkUgSVMgVEhFIFBST1BFUlRZIE9GIEFORCBDT05UQUlOUyAgICAgICAgICAgICAqCiAqICAgQ09ORklERU5USUFMIElORk9STUFUSU9OIE9GIElORk9SIEFORC9PUiBJVFMgQUZGSUxJQVRFUyAgICoKICogICBPUiBTVUJTSURJQVJJRVMgQU5EIFNIQUxMIE5PVCBCRSBESVNDTE9TRUQgV0lUSE9VVCBQUklPUiAgKgogKiAgIFdSSVRURU4gUEVSTUlTU0lPTi4gTElDRU5TRUQgQ1VTVE9NRVJTIE1BWSBDT1BZIEFORCAgICAgICAqCiAqICAgQURBUFQgVEhJUyBTT0ZUV0FSRSBGT1IgVEhFSVIgT1dOIFVTRSBJTiBBQ0NPUkRBTkNFIFdJVEggICoKICogICBUSEUgVEVSTVMgT0YgVEhFSVIgU09GVFdBUkUgTElDRU5TRSBBR1JFRU1FTlQuICAgICAgICAgICAgKgogKiAgIEFMTCBPVEhFUiBSSUdIVFMgUkVTRVJWRUQuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoKICogICAoYykgQ09QWVJJR0hUIDIwMjAgSU5GT1IuICBBTEwgUklHSFRTIFJFU0VSVkVELiAgICAgICAgICAgKgogKiAgIFRIRSBXT1JEIEFORCBERVNJR04gTUFSS1MgU0VUIEZPUlRIIEhFUkVJTiBBUkUgICAgICAgICAgICAqCiAqICAgVFJBREVNQVJLUyBBTkQvT1IgUkVHSVNURVJFRCBUUkFERU1BUktTIE9GIElORk9SICAgICAgICAgICoKICogICBBTkQvT1IgSVRTIEFGRklMSUFURVMgQU5EIFNVQlNJRElBUklFUy4gQUxMIFJJR0hUUyAgICAgICAgKgogKiAgIFJFU0VSVkVELiAgQUxMIE9USEVSIFRSQURFTUFSS1MgTElTVEVEIEhFUkVJTiBBUkUgICAgICAgICAqCiAqICAgVEhFIFBST1BFUlRZIE9GIFRIRUlSIFJFU1BFQ1RJVkUgT1dORVJTLiAgICAgICAgICAgICAgICAgICoKICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgogKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCiovCiAKaW1wb3J0IGdyb292eS5sYW5nLkNsb3N1cmU7CmltcG9ydCBncm9vdnkuanNvbi5Kc29uU2x1cnBlcjsKCmltcG9ydCBqYXZhLnRpbWUuTG9jYWxEYXRlOwppbXBvcnQgamF2YS50aW1lLkxvY2FsRGF0ZVRpbWU7CmltcG9ydCBqYXZhLnRpbWUuZm9ybWF0LkRhdGVUaW1lRm9ybWF0dGVyOwppbXBvcnQgamF2YS50aW1lLmZvcm1hdC5EYXRlVGltZVBhcnNlRXhjZXB0aW9uCmltcG9ydCBqYXZhLnRpbWUuWm9uZUlkOwoKLyoKKk1vZGlmaWNhdGlvbiBhcmVhIC0gTTMKKk5iciAgICAgICAgICAgICAgIERhdGUgICAgICBVc2VyIGlkICAgICBEZXNjcmlwdGlvbgoqRVhUMTAyICAgICAgICAgICAgMjAyNDAxMTYgIFJNVVJSQVkgICAgIFVwZGF0ZSBFWFQgYXBpIHRvIGhhbmRsZSBwb3J0YWwgdXBkYXRlcyBhbmQgbG9nZ2luZwoqRVhUMTAyICAgICAgICAgICAgMjAyNDAyMDUgIFJNVVJSQVkgICAgIFZhbGlkYXRpb24gb24gSU9OIEFQSSBjYWxsLiAKKkVYVDEwMiAgICAgICAgICAgIDIwMjQwNDE0ICBSTVVSUkFZICAgICBBZGQgaW4gUE8gTGluZSBjb25maXJtYXRpb24KKkVYVDEwMiAgICAgICAgICAgIDIwMjQwNTAxICBSTVVSUkFZICAgICBQcmVwYXJlIGZvciBzdWJtaXNzaW9uLCBQUkQgQXBwcm92YWwuCiovCgovKgoqIFVwZFBPTGluZQoqLwpwdWJsaWMgY2xhc3MgVXBkUE9MaW5lIGV4dGVuZHMgRXh0ZW5kTTNUcmFuc2FjdGlvbiB7CgoJcHJpdmF0ZSBmaW5hbCBNSUFQSSBtaTsKCXByaXZhdGUgZmluYWwgRGF0YWJhc2VBUEkgZGF0YWJhc2U7Cglwcml2YXRlIGZpbmFsIExvZ2dlckFQSSBsb2dnZXI7Cglwcml2YXRlIGZpbmFsIFByb2dyYW1BUEkgcHJvZ3JhbTsKCXByaXZhdGUgZmluYWwgSW9uQVBJIGlvbjsKCglwcml2YXRlIFN0cmluZyBwdW5vOwoJcHJpdmF0ZSBTdHJpbmcgcG5saTsKCXByaXZhdGUgU3RyaW5nIHBubHM7Cglwcml2YXRlIFN0cmluZyBwdXByOwoJcHJpdmF0ZSBTdHJpbmcgZHdkdDsKCXByaXZhdGUgU3RyaW5nIHBpdGQ7Cglwcml2YXRlIFN0cmluZyBwaXR0OwoJcHJpdmF0ZSBTdHJpbmcgdGVsMTsKCXByaXZhdGUgU3RyaW5nIGVtYWw7Cglwcml2YXRlIFN0cmluZyBzdW5vOwoJcHJpdmF0ZSBTdHJpbmcgaXRubzsKCXByaXZhdGUgU3RyaW5nIG9ycWE7Cglwcml2YXRlIFN0cmluZyBjcnVkOwoJcHJpdmF0ZSBTdHJpbmcgcHVwck9sZDsKCXByaXZhdGUgU3RyaW5nIGR3ZHRPbGQ7Cglwcml2YXRlIFN0cmluZyBwaXRkT2xkOwoJcHJpdmF0ZSBTdHJpbmcgcGl0dE9sZDsKCXByaXZhdGUgU3RyaW5nIHRlbDFPbGQ7Cglwcml2YXRlIFN0cmluZyBvcnFhT2xkOwoJcHJpdmF0ZSBTdHJpbmcgY3VycmVudERhdGVUaW1lOwoKCXByaXZhdGUgbG9uZyBwdW5vTG9uZzsKCglwcml2YXRlIGludCBjdXJyZW50RGF0ZTsKCXByaXZhdGUgaW50IGN1cnJlbnRUaW1lOwoJcHJpdmF0ZSBpbnQgWFhDT05POwoKCXByaXZhdGUgYm9vbGVhbiBpc0RhdGVQYXJzZWQ7CgoJcHVibGljIFVwZFBPTGluZShNSUFQSSBtaSwgRGF0YWJhc2VBUEkgZGF0YWJhc2UsIExvZ2dlckFQSSBsb2dnZXIsIFByb2dyYW1BUEkgcHJvZ3JhbSwgSW9uQVBJIGlvbikgewoJCXRoaXMubWkgPSBtaTsKCQl0aGlzLmRhdGFiYXNlID0gZGF0YWJhc2U7CgkJdGhpcy5sb2dnZXIgPSBsb2dnZXI7CgkJdGhpcy5wcm9ncmFtID0gcHJvZ3JhbTsKCQl0aGlzLmlvbiA9IGlvbjsgCgl9CgoJcHVibGljIHZvaWQgbWFpbigpIHsKCQkvKioKICAgICpGZXRjaCBpbnB1dCBmaWVsZHMgZnJvbSBNSQogICAgKi8KCQlwdW5vID0gbWkuaW5EYXRhLmdldCgiUFVOTyIpID09IG51bGwgPyAnJyA6IG1pLmluRGF0YS5nZXQoIlBVTk8iKS50cmltKCk7CgkJaWYgKHB1bm8gPT0gIj8iKSB7CgkJCXB1bm8gPSAiIjsKCQl9IAoJCXBubGkgPSBtaS5pbkRhdGEuZ2V0KCJQTkxJIikgPT0gbnVsbCA/ICcnIDogbWkuaW5EYXRhLmdldCgiUE5MSSIpLnRyaW0oKTsKCQlpZiAocG5saSA9PSAiPyIpIHsKCQkJcG5saSA9ICIiOwoJCX0gCgkJcG5scyA9IG1pLmluRGF0YS5nZXQoIlBOTFMiKSA9PSBudWxsID8gJycgOiBtaS5pbkRhdGEuZ2V0KCJQTkxTIikudHJpbSgpOwoJCWlmIChwbmxzID09ICI/IikgewoJCQlwbmxzID0gIiI7CgkJfSAKCQl0ZWwxID0gbWkuaW5EYXRhLmdldCgiVEVMMSIpID09IG51bGwgPyAnJyA6IG1pLmluRGF0YS5nZXQoIlRFTDEiKS50cmltKCk7CgkJaWYgKHRlbDEgPT0gIj8iKSB7CgkJCXRlbDEgPSAiIjsKCQl9IAoJCXBpdGQgPSBtaS5pbkRhdGEuZ2V0KCJQSVREIikgPT0gbnVsbCA/ICcnIDogbWkuaW5EYXRhLmdldCgiUElURCIpLnRyaW0oKTsKCQlpZiAocGl0ZCA9PSAiPyIpIHsKCQkJcGl0ZCA9ICIiOwoJCX0gCgkJcGl0dCA9IG1pLmluRGF0YS5nZXQoIlBJVFQiKSA9PSBudWxsID8gJycgOiBtaS5pbkRhdGEuZ2V0KCJQSVRUIikudHJpbSgpOwoJCWlmIChwaXR0ID09ICI/IikgewoJCQlwaXR0ID0gIiI7CgkJfSAKCQlwdXByID0gbWkuaW5EYXRhLmdldCgiUFVQUiIpID09IG51bGwgPyAnJyA6IG1pLmluRGF0YS5nZXQoIlBVUFIiKS50cmltKCk7CgkJaWYgKHB1cHIgPT0gIj8iKSB7CgkJCXB1cHIgPSAiIjsKCQl9ICAgICAKCQlkd2R0ID0gbWkuaW5EYXRhLmdldCgiRFdEVCIpID09IG51bGwgPyAnJyA6IG1pLmluRGF0YS5nZXQoIkRXRFQiKS50cmltKCk7CgkJaWYgKGR3ZHQgPT0gIj8iKSB7CgkJCWR3ZHQgPSAiIjsKCQl9IAoJCXRlbDEgPSBtaS5pbkRhdGEuZ2V0KCJURUwxIikgPT0gbnVsbCA/ICcnIDogbWkuaW5EYXRhLmdldCgiVEVMMSIpLnRyaW0oKTsKCQlpZiAodGVsMSA9PSAiPyIpIHsKCQkJdGVsMSA9ICIiOwoJCX0gCgkJZW1hbCA9IG1pLmluRGF0YS5nZXQoIkVNQUwiKSA9PSBudWxsID8gJycgOiBtaS5pbkRhdGEuZ2V0KCJFTUFMIikudHJpbSgpOwoJCWlmIChlbWFsID09ICI/IikgewoJCQllbWFsID0gIiI7CgkJfSAKCQlwaXR0T2xkID0gbWkuaW5EYXRhLmdldCgiUElUMiIpID09IG51bGwgPyAnJyA6IG1pLmluRGF0YS5nZXQoIlBJVDIiKS50cmltKCk7CgkJaWYgKHBpdHRPbGQgPT0gIj8iKSB7CgkJCXBpdHRPbGQgPSAiIjsKCQl9IAoJCXBpdGRPbGQgPSBtaS5pbkRhdGEuZ2V0KCJQSVRPIikgPT0gbnVsbCA/ICcnIDogbWkuaW5EYXRhLmdldCgiUElUTyIpLnRyaW0oKTsKCQlpZiAocGl0ZE9sZCA9PSAiPyIpIHsKCQkJcGl0ZE9sZCA9ICIiOwoJCX0gCgkJcHVwck9sZCA9IG1pLmluRGF0YS5nZXQoIlBVUE8iKSA9PSBudWxsID8gJycgOiBtaS5pbkRhdGEuZ2V0KCJQVVBPIikudHJpbSgpOwoJCWlmIChwdXByT2xkID09ICI/IikgewoJCQlwdXByT2xkID0gIiI7CgkJfSAgICAgCgkJZHdkdE9sZCA9IG1pLmluRGF0YS5nZXQoIkRXRE8iKSA9PSBudWxsID8gJycgOiBtaS5pbkRhdGEuZ2V0KCJEV0RPIikudHJpbSgpOwoJCWlmIChkd2R0T2xkID09ICI/IikgewoJCQlkd2R0T2xkID0gIiI7CgkJfSAKCQl0ZWwxT2xkID0gbWkuaW5EYXRhLmdldCgiVEVMTyIpID09IG51bGwgPyAnJyA6IG1pLmluRGF0YS5nZXQoIlRFTE8iKS50cmltKCk7CgkJaWYgKHRlbDFPbGQgPT0gIj8iKSB7CgkJCXRlbDFPbGQgPSAiIjsKCQl9IAoJCWNydWQgPSBtaS5pbkRhdGEuZ2V0KCJDUlVEIikgPT0gbnVsbCA/ICcnIDogbWkuaW5EYXRhLmdldCgiQ1JVRCIpLnRyaW0oKTsKCQlpZiAoY3J1ZCA9PSAiPyIpIHsKCQkJY3J1ZCA9ICIiOwoJCX0gCgkJc3VubyA9ICIiOwoJCWl0bm8gPSAiIjsKCQlvcnFhID0gIiI7CgkJb3JxYU9sZCA9ICIiOwoKCQkvKgogICAgKiBQZXJmb3JtIHZhbGlkYXRpb24gb24gaW5wdXQgdmFyaWFibGVzCiAgICAqLwoJCWlmICghdmFsaWRhdGVJbnB1dCgpKSB7CgkJCXJldHVybjsKCQl9CgoJCS8qCiAgICAqIFNldCBEYXRlIFZhcmlhYmxlcyB3aXRoIGN1c3RvbWVyIGxvY2FsIHRpbWUgem9uZQogICAgKi8KCQlab25lSWQgemlkID0gWm9uZUlkLm9mKCJBdXN0cmFsaWEvQnJpc2JhbmUiKTsgCgkJY3VycmVudERhdGUgPSBMb2NhbERhdGUubm93KHppZCkuZm9ybWF0KERhdGVUaW1lRm9ybWF0dGVyLm9mUGF0dGVybigieXl5eU1NZGQiKSkudG9JbnRlZ2VyKCk7CgkJY3VycmVudFRpbWUgPSBJbnRlZ2VyLnZhbHVlT2YoTG9jYWxEYXRlVGltZS5ub3coKS5mb3JtYXQoRGF0ZVRpbWVGb3JtYXR0ZXIub2ZQYXR0ZXJuKCJISG1tc3MiKSkpOwoJCWN1cnJlbnREYXRlVGltZSA9ICAoTG9jYWxEYXRlLm5vdyh6aWQpLmZvcm1hdChEYXRlVGltZUZvcm1hdHRlci5vZlBhdHRlcm4oImRkIE1NTSB5eXl5IikpICsgIiAiICsgTG9jYWxEYXRlVGltZS5ub3coKS5mb3JtYXQoRGF0ZVRpbWVGb3JtYXR0ZXIub2ZQYXR0ZXJuKCJISDptbTpzcyIpKSkudG9TdHJpbmcoKSArICIgQUVTVCI7IAoKICAgIC8qCiAgICAqIFJldHJpZXZlIHB1cmNoYXNlIG9yZGVyIGxpbmUgaW5mb3JtYXRpb24gdmlhIEFQSSBQUFMyMDBNSV9HZXRMaW5lCiAgICAqLwogICAgTWFwPFN0cmluZywgU3RyaW5nPiBwYXJhbXNQT0xpbmUgPSBbICJDT05PIjogWFhDT05PLnRvU3RyaW5nKCksICJQVU5PIjogcHVubywgIlBOTEkiOiBwbmxpLCAiUE5MUyI6IHBubHMgXTsKCQlTdHJpbmcgdXJsUE9MaW5lID0gIi9NMy9tM2FwaS1yZXN0L3YyL2V4ZWN1dGUvUFBTMjAwTUkvR2V0TGluZSI7CgkKCQlNYXA8U3RyaW5nLFN0cmluZz4gaGVhZGVyc1BPTGluZSA9IFsiQWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24iXTsKCQlJb25SZXNwb25zZSByZXNwb25zZVBPTGluZSA9IGlvbi5nZXQodXJsUE9MaW5lLCBoZWFkZXJzUE9MaW5lLCBwYXJhbXNQT0xpbmUpOwoKICAgIGlmKHJlc3BvbnNlUE9MaW5lLmdldEVycm9yKCkpewogICAgICBsb2dnZXIuZGVidWcoIkZhaWxlZCBjYWxsaW5nIElPTiBBUEkgJHt1cmxQT0xpbmV9LCBkZXRhaWxlZCBlcnJvciBtZXNzYWdlOiAke3Jlc3BvbnNlUE9MaW5lLmdldEVycm9yTWVzc2FnZSgpfSIpOwogICAgICBtaS5lcnJvcigiY2FsbGluZyBhcGkgZmFpbGVkICR7dXJsUE9MaW5lfSAiICsgcmVzcG9uc2VQT0xpbmUuZ2V0RXJyb3JNZXNzYWdlKCkpOwogICAgICByZXR1cm47CiAgICB9CgoKICAgIGlmIChyZXNwb25zZVBPTGluZS5nZXRTdGF0dXNDb2RlKCkgIT0gMjAwKSB7CiAgICAgIG1pLmVycm9yKCJJbmNvcnJlY3Qgc3RhdHVzLCBubyBwYXlsb2FkIik7CiAgICAgIHJldHVybjsKICAgIH0gCiAgICAgIAogICAgLyoKICAgICogSWYgcGF5bG9hZCBpcyBmb3IgUE8gQ29uZmlybWF0aW9uICJDTkYiCiAgICAqLwoJICBpZihjcnVkID09ICJDTkYiKXsKCQkJSnNvblNsdXJwZXIganNvblNsdXJwZXIgPSBuZXcgSnNvblNsdXJwZXIoKTsKCQkJTWFwPFN0cmluZywgT2JqZWN0PiBtaVJlc3BvbnNlID0gKE1hcDxTdHJpbmcsIE9iamVjdD4pIGpzb25TbHVycGVyLnBhcnNlVGV4dChyZXNwb25zZVBPTGluZS5nZXRDb250ZW50KCkpOwoJCQlBcnJheUxpc3Q8TWFwPFN0cmluZywgT2JqZWN0Pj4gcmVzdWx0cyA9IChBcnJheUxpc3Q8TWFwPFN0cmluZywgT2JqZWN0Pj4pIG1pUmVzcG9uc2UuZ2V0KCJyZXN1bHRzIik7CgkJCUFycmF5TGlzdDxNYXA8U3RyaW5nLCBTdHJpbmc+PiByZWNvcmRMaXN0ID0gKEFycmF5TGlzdDxNYXA8U3RyaW5nLCBTdHJpbmc+PikgcmVzdWx0c1swXVsicmVjb3JkcyJdOwoJCQlyZWNvcmRMaXN0LmVhY2hXaXRoSW5kZXggeyBpdCwgaW5kZXggLT4KCQkJCU1hcDxTdHJpbmcsIFN0cmluZz4gcmVjb3JkTVBMSU5FID0gKE1hcDxTdHJpbmcsIFN0cmluZz4pIGl0OwoJCQkJaWYgKHJlY29yZE1QTElORS5TVU5PICE9IG51bGwpIHsKCQkJCQlpdG5vID0gcmVjb3JkTVBMSU5FLklUTk87CgkJCQkJc3VubyA9IHJlY29yZE1QTElORS5TVU5POwoJCQkJCW9ycWFPbGQgPSByZWNvcmRNUExJTkUuT1JRQTsKCQkJCQlvcnFhID0gcmVjb3JkTVBMSU5FLk9SUUE7CgkJCQkJaWYoIWlzU3RyaW5nTnVsbE9yRW1wdHkocHVwcikgJiYgaXNTdHJpbmdOdWxsT3JFbXB0eShwdXByT2xkKSl7CgkJCQkJCXB1cHJPbGQgPSByZWNvcmRNUExJTkUuUFVQUjsgIAoJCQkJCX0KCQkJCQlpZighaXNTdHJpbmdOdWxsT3JFbXB0eShkd2R0KSAmJiBpc1N0cmluZ051bGxPckVtcHR5KGR3ZHRPbGQpKXsKCQkJCQkJZHdkdE9sZCA9IHJlY29yZE1QTElORS5EV0RUOwoJCQkJCX0KCQkJCX0KCQkJfQoJCQogICAgICAvKgogICAgICAqIFBlcmZvcm0gUE8gTGluZSBDb25maXJtYXRpb24gdmlhIEFQSSBQUFMxMDBNSV9Db25maXJtTGluZQogICAgICAqLwoJCQlNYXA8U3RyaW5nLCBTdHJpbmc+IHBhcmFtcyA9IG5ldyBIYXNoTWFwPFN0cmluZyxTdHJpbmc+KCk7CgkJCVN0cmluZyB1cmxDb25maXJtTGluZSA9ICIvTTMvbTNhcGktcmVzdC92Mi9leGVjdXRlL1BQUzAwMU1JL0NvbmZpcm1MaW5lIjsKCQkJcGFyYW1zID0gWyAiUFVOTyI6IHB1bm8sICAiUE5MSSI6IHBubGksICJQTkxTIjogcG5scyBdOwoJCQlpZighaXNTdHJpbmdOdWxsT3JFbXB0eShwdXByKSl7CgkJCQlwYXJhbXMucHV0KCJQVVBSIiwgcHVwcik7CgkJCX0KCQkJaWYoIWlzU3RyaW5nTnVsbE9yRW1wdHkoZHdkdCkpewoJCQkJcGFyYW1zLnB1dCgiRFdEVCIsIGR3ZHQpOwoJCQl9CgkJCU1hcDxTdHJpbmcsU3RyaW5nPiBoZWFkZXJzID0gWyJBY2NlcHQiOiAiYXBwbGljYXRpb24vanNvbiJdOwoJCQlJb25SZXNwb25zZSByZXNwb25zZSA9IGlvbi5nZXQodXJsQ29uZmlybUxpbmUsIGhlYWRlcnMsIHBhcmFtcyk7CgkJCWlmKHJlc3BvbnNlLmdldEVycm9yKCkpewoJCQkJbG9nZ2VyLmRlYnVnKCJGYWlsZWQgY2FsbGluZyBJT04gQVBJICR7dXJsQ29uZmlybUxpbmV9LCBkZXRhaWxlZCBlcnJvciBtZXNzYWdlOiAke3Jlc3BvbnNlLmdldEVycm9yTWVzc2FnZSgpfSIpOwoJCQkJbWkuZXJyb3IoImNhbGxpbmcgYXBpIGZhaWxlZCAke3VybENvbmZpcm1MaW5lfSAiICsgcmVzcG9uc2UuZ2V0RXJyb3JNZXNzYWdlKCkpOwoJCQkJcmV0dXJuOwoJCQl9CiAgICAgIAogICAgfSBlbHNlIHsKICAgICAgLyoKICAgICAgKiBJZiBwYXlsb2FkIGlzIG5vdCBmb3IgUE8gTGluZSBDb25maXJtYXRpb24sIEFzc3VtZWQgYXMgYSBQTyBMaW5lIFVwZGF0ZS4KICAgICAgKi8KCQkJSnNvblNsdXJwZXIganNvblNsdXJwZXIgPSBuZXcgSnNvblNsdXJwZXIoKTsKCQkJTWFwPFN0cmluZywgT2JqZWN0PiBtaVJlc3BvbnNlID0gKE1hcDxTdHJpbmcsIE9iamVjdD4pIGpzb25TbHVycGVyLnBhcnNlVGV4dChyZXNwb25zZVBPTGluZS5nZXRDb250ZW50KCkpOwoJCQlBcnJheUxpc3Q8TWFwPFN0cmluZywgT2JqZWN0Pj4gcmVzdWx0cyA9IChBcnJheUxpc3Q8TWFwPFN0cmluZywgT2JqZWN0Pj4pIG1pUmVzcG9uc2UuZ2V0KCJyZXN1bHRzIik7CgkJCUFycmF5TGlzdDxNYXA8U3RyaW5nLCBTdHJpbmc+PiByZWNvcmRMaXN0ID0gKEFycmF5TGlzdDxNYXA8U3RyaW5nLCBTdHJpbmc+PikgcmVzdWx0c1swXVsicmVjb3JkcyJdOwoJCQlyZWNvcmRMaXN0LmVhY2hXaXRoSW5kZXggeyBpdCwgaW5kZXggLT4KCQkJCU1hcDxTdHJpbmcsIFN0cmluZz4gcmVjb3JkTVBMSU5FID0gKE1hcDxTdHJpbmcsIFN0cmluZz4pIGl0OwoJCQkJaWYgKHJlY29yZE1QTElORS5TVU5PICE9IG51bGwpIHsKCQkJCQlpdG5vID0gcmVjb3JkTVBMSU5FLklUTk87CgkJCQkJc3VubyA9IHJlY29yZE1QTElORS5TVU5POwoJCQkJCW9ycWFPbGQgPSByZWNvcmRNUExJTkUuT1JRQTsKCQkJCQlvcnFhID0gcmVjb3JkTVBMSU5FLk9SUUE7CgkJCQkJaWYoaXNTdHJpbmdOdWxsT3JFbXB0eShwdXByT2xkKSl7CgkJCQkJCXB1cHJPbGQgPSByZWNvcmRNUExJTkUuUFVQUjsgIAoJCQkJCX0KCQkJCQlpZihpc1N0cmluZ051bGxPckVtcHR5KHRlbDFPbGQpKXsKCQkJCQkJdGVsMU9sZCA9IHJlY29yZE1QTElORS5URUwxOyAgCgkJCQkJfQoJCQkJCWlmKGlzU3RyaW5nTnVsbE9yRW1wdHkocGl0ZE9sZCkpewoJCQkJCQlwaXRkT2xkID0gcmVjb3JkTVBMSU5FLlBJVEQ7CgkJCQkJfQoJCQkJCWlmKGlzU3RyaW5nTnVsbE9yRW1wdHkocGl0dE9sZCkpewoJCQkJCQlwaXR0T2xkID0gcmVjb3JkTVBMSU5FLlBJVFQ7CgkJCQkJfQoJCQkJCWlmKGlzU3RyaW5nTnVsbE9yRW1wdHkoZHdkdE9sZCkpewoJCQkJCQlkd2R0T2xkID0gcmVjb3JkTVBMSU5FLkRXRFQ7CgkJCQkJfQoJCQkJfQoJCQl9CgkJfQoJCQoJCQoJCS8qCiAgICAqIFBlcmZvcm0gVXBkYXRlIG9uIFBPIExpbmUgdmlhIEFQSSBQUFMyMDBNSV9VcGRMaW5lCiAgICAqLwoJCU1hcDxTdHJpbmcsIFN0cmluZz4gcGFyYW1zID0gbmV3IEhhc2hNYXA8U3RyaW5nLFN0cmluZz4oKTsKCQlTdHJpbmcgdXJsVXBkTGluZSA9ICIvTTMvbTNhcGktcmVzdC92Mi9leGVjdXRlL1BQUzIwME1JL1VwZExpbmUiOwoJCXBhcmFtcyA9IFsgIlBVTk8iOiBwdW5vLCAgIlBOTEkiOiBwbmxpLCAiUE5MUyI6IHBubHMgXTsKCQlpZighaXNTdHJpbmdOdWxsT3JFbXB0eShwdXByKSl7CgkJCXBhcmFtcy5wdXQoIlBVUFIiLCBwdXByKTsKCQl9CgkJaWYoIWlzU3RyaW5nTnVsbE9yRW1wdHkoZHdkdCkpewoJCQlwYXJhbXMucHV0KCJEV0RUIiwgZHdkdCk7CgkJfQoJCWlmKCFpc1N0cmluZ051bGxPckVtcHR5KHBpdGQpKXsKCQkJcGFyYW1zLnB1dCgiUElURCIsIHBpdGQpOwoJCX0KCQlpZighaXNTdHJpbmdOdWxsT3JFbXB0eShwaXR0KSl7CgkJCXBhcmFtcy5wdXQoIlBJVFQiLCBwaXR0KTsKCQl9CgkJaWYoIWlzU3RyaW5nTnVsbE9yRW1wdHkodGVsMSkpewoJCQlwYXJhbXMucHV0KCJURUwxIiwgdGVsMSk7CgkJfQoJCU1hcDxTdHJpbmcsU3RyaW5nPiBoZWFkZXJzID0gWyJBY2NlcHQiOiAiYXBwbGljYXRpb24vanNvbiJdOwoJCUlvblJlc3BvbnNlIHJlc3BvbnNlID0gaW9uLmdldCh1cmxVcGRMaW5lLCBoZWFkZXJzLCBwYXJhbXMpOwoJCWlmKHJlc3BvbnNlLmdldEVycm9yKCkpewoJCQlsb2dnZXIuZGVidWcoIkZhaWxlZCBjYWxsaW5nIElPTiBBUEkgJHt1cmxVcGRMaW5lfSwgZGV0YWlsZWQgZXJyb3IgbWVzc2FnZTogJHtyZXNwb25zZS5nZXRFcnJvck1lc3NhZ2UoKX0iKTsKCQkJbWkuZXJyb3IoImNhbGxpbmcgYXBpIGZhaWxlZCAke3VybFVwZExpbmV9ICIgKyByZXNwb25zZS5nZXRFcnJvck1lc3NhZ2UoKSk7CgkJCXJldHVybjsKCQl9CgkJCgkJLyoKICAgICogV3JpdGUgbG9nIHZhbHVlcyB0byBleHRlbnNpb24gdGFibGUgRVhUU1BaCiAgICAqLwoJICB3cml0ZUVYVCgpCgkJCiAgIAogIAkgIAoJfQoKCS8qCgkqIHZhbGlkYXRlSW5wdXQgLSBWYWxpZGF0ZSBhbGwgdGhlIGlucHV0IGZpZWxkcwoJKiBAcmV0dXJuIGZhbHNlIGlmIHRoZXJlIGlzIGFueSBlcnJvcgoJKiAgICAgICAgIHRydWUgaWYgcGFzcyB0aGUgdmFsaWRhdGlvbgoJKi8KCXByaXZhdGUgYm9vbGVhbiB2YWxpZGF0ZUlucHV0KCl7CgogICAgLyoKICAgICogU2V0IGNvbXBhbnkgbnVtYmVyCiAgICAqLwoJCVhYQ09OTz0gcHJvZ3JhbS5MREFaRC5DT05POwoKICAgIC8qCiAgICAqIENSVUQgZmllbGQgbXVzdCBub3QgYmUgbnVsbCBvciBlbXB0eQogICAgKi8KCQlpZihpc1N0cmluZ051bGxPckVtcHR5KGNydWQpKXsKCQkJbG9nZ2VyLmRlYnVnKCJtaS5lcnJvcjogQ1JVRCB2YWx1ZSBpcyBudWxsIG9yIGVtcHR5Iik7CgkJCW1pLmVycm9yKCJDcnVkIHZhbHVlIG5vdCBzcGVjaWZpZWQiKQoJCQlyZXR1cm4gZmFsc2U7CgkJfSAKCiAgICAvKgogICAgKiBDUlVEIG11c3QgYmUgVVBEIG9yIENORgogICAgKi8KCQlpZihjcnVkICE9ICJVUEQiICYmIGNydWQgIT0gIkNORiIpewoJCQlsb2dnZXIuZGVidWcoIm1pLmVycm9yOiBDUlVEIGlucHV0IGlzIGluY29ycmVjdCAiICsgY3J1ZCk7CgkJCW1pLmVycm9yKCJDUlVEIG11c3QgYmUgVVBEIG9yIENORiIpOwoJCQlyZXR1cm4gZmFsc2U7CgkJfQoKICAgIC8qCiAgICAqIFZhbGlkYXRlIGtleSBmaWVsZHMgdXNlZCBmb3IgYXBpIGNhbGwKICAgICovCgkJU3RyaW5nIHB1cmNoYXNlT3JkZXJMaW5lID0gaXNTdHJpbmdOdWxsT3JFbXB0eShwdW5vKSA/ICJQVU5PIiA6IGlzU3RyaW5nTnVsbE9yRW1wdHkocG5saSkgPyAiUE5MSSIgOiBpc1N0cmluZ051bGxPckVtcHR5KHBubHMpID8gIlBOTFMiIDogIiI7CgkJaWYgKCFpc1N0cmluZ051bGxPckVtcHR5KHB1cmNoYXNlT3JkZXJMaW5lKSkgewoJCQltaS5lcnJvcigiJHtwdXJjaGFzZU9yZGVyTGluZX0sIG5vdCBkZWZpbmVkIik7CgkJCXJldHVybiBmYWxzZTsKCQl9CgogICAgLyoKICAgICogVmFsaWRhdGUgZHdkdCBhcyBkYXRlIE1vdmV4RGF0ZQogICAgKi8KICAgIGlmKGNydWQgPT0gIkNORiIpCiAgICB7CiAgICAgIGlmKCFpc1N0cmluZ051bGxPckVtcHR5KGR3ZHQpKXsKICAgICAgICB0cnlQYXJzZURhdGUoZHdkdCk7CiAgICAgIH0KICAgICAgaWYoIWlzU3RyaW5nTnVsbE9yRW1wdHkoZHdkdE9sZCkpewogICAgICAgIHRyeVBhcnNlRGF0ZShkd2R0T2xkKTsKICAgICAgfQogICAgICAKICAgIH0gZWxzZSB7CiAgICAgIHRyeVBhcnNlRGF0ZShkd2R0KTsKICAgICAgaWYoIWlzU3RyaW5nTnVsbE9yRW1wdHkoZHdkdE9sZCkpewogICAgICAgIHRyeVBhcnNlRGF0ZShkd2R0T2xkKTsKICAgICAgfQogICAgfQoKICAgIC8qCiAgICAqIFZhbGlkYXRlIHVzZXIgZW1haWwgbm90IGVtcHR5CiAgICAqLwoJCWlmKGlzU3RyaW5nTnVsbE9yRW1wdHkoZW1hbCkpewoJCQltaS5lcnJvcigiRU1BTCBub3Qgc3VwcGxpZWQiKTsKCQkJcmV0dXJuIGZhbHNlOwoJCX0KCgkJLyoKICAgICogVmFsaWRhdGlvbiBTdWNjZXNzZnVsCiAgICAqLwoJCXJldHVybiB0cnVlOwoJfQoKICAvKgoJKiB3cml0ZUVYVAoJKiBDcmVhdGUgbG9nIGVudHJ5IGluIHRhYmxlIEVYVFNQWgoJKi8KICBwcml2YXRlIHZvaWQgd3JpdGVFWFQoKSB7CgkJREJBY3Rpb24gYWN0aW9uRVhUU1BaID0gZGF0YWJhc2UudGFibGUoIkVYVFNQWiIpLmJ1aWxkKCk7CgkJREJDb250YWluZXIgRVhUU1BaID0gYWN0aW9uRVhUU1BaLmdldENvbnRhaW5lcigpOwoJCUVYVFNQWi5zZXQoIkVYQ09OTyIsIFhYQ09OTyk7CgkJRVhUU1BaLnNldCgiRVhTVU5PIiwgc3Vubyk7CgkJRVhUU1BaLnNldCgiRVhJVE5PIiwgaXRubyk7CgkJRVhUU1BaLnNldCgiRVhQVU5PIiwgcHVubyk7CgkJRVhUU1BaLnNldCgiRVhQTkxJIiwgcG5saS50b0ludGVnZXIoKSk7CgkJRVhUU1BaLnNldCgiRVhQTkxTIiwgcG5scy50b0ludGVnZXIoKSk7CgkJRVhUU1BaLnNldCgiRVhPUlFBIiwgb3JxYS50b0RvdWJsZSgpKTsKCQlFWFRTUFouc2V0KCJFWE9SUU8iLCBvcnFhT2xkLnRvRG91YmxlKCkpOwoJCWlmKCFpc1N0cmluZ051bGxPckVtcHR5KHB1cHIpKXsKCQkJRVhUU1BaLnNldCgiRVhQVVBSIiwgcHVwci50b0RvdWJsZSgpKTsKCQkJaWYoIWlzU3RyaW5nTnVsbE9yRW1wdHkocHVwck9sZCkpewoJCQkJRVhUU1BaLnNldCgiRVhQVVBPIiwgcHVwck9sZC50b0RvdWJsZSgpKTsKCQkJfQoJCX0KCQlpZighaXNTdHJpbmdOdWxsT3JFbXB0eShkd2R0KSl7CgkJCUVYVFNQWi5zZXQoIkVYRFdEVCIsIGR3ZHQudG9JbnRlZ2VyKCkpOwoJCQlpZighaXNTdHJpbmdOdWxsT3JFbXB0eShkd2R0T2xkKSl7IAoJCQkJRVhUU1BaLnNldCgiRVhEV0RPIiwgZHdkdE9sZC50b0ludGVnZXIoKSk7CgkJCX0KCQl9CgkJaWYoIWlzU3RyaW5nTnVsbE9yRW1wdHkocGl0ZCkpewoJCQlFWFRTUFouc2V0KCJFWFBJVEQiLCBwaXRkKTsKCQkJaWYoaXNTdHJpbmdOdWxsT3JFbXB0eShwaXRkT2xkKSl7CgkJCQlFWFRTUFouc2V0KCJFWFBJVE8iLCBwaXRkT2xkKTsKCQkJfQoJCX0KCQlpZighaXNTdHJpbmdOdWxsT3JFbXB0eShwaXR0KSl7CgkJCUVYVFNQWi5zZXQoIkVYUElUVCIsIHBpdHQpOwoJCQlpZighaXNTdHJpbmdOdWxsT3JFbXB0eShwaXR0T2xkKSl7CgkJCQlFWFRTUFouc2V0KCJFWFBJVDIiLCBwaXR0T2xkKTsKCQkJfQoJCX0KCQlpZighaXNTdHJpbmdOdWxsT3JFbXB0eSh0ZWwxKSl7CgkJCUVYVFNQWi5zZXQoIkVYVEVMMSIsIHRlbDEpOwoJCQlpZighaXNTdHJpbmdOdWxsT3JFbXB0eSh0ZWwxT2xkKSl7CgkJCQlFWFRTUFouc2V0KCJFWFRFTE8iLCB0ZWwxT2xkKTsKCQkJfQoJCX0KCQlFWFRTUFouc2V0KCJFWEVNQUwiLCBlbWFsKTsKCQlFWFRTUFouc2V0KCJFWExNRFQiLCBjdXJyZW50RGF0ZS50b0ludGVnZXIoKSk7CgkJRVhUU1BaLnNldCgiRVhMTVRNIiwgY3VycmVudFRpbWUudG9JbnRlZ2VyKCkpOwoJCUVYVFNQWi5zZXQoIkVYRFRYWCIsIGN1cnJlbnREYXRlVGltZSk7CgkJRVhUU1BaLnNldCgiRVhDUlVEIiwgY3J1ZCk7IAoJCWFjdGlvbkVYVFNQWi5pbnNlcnQoRVhUU1BaLCByZWNvcmRFeGlzdHMpOwoJfQoJCgkvKgoJKiByZWNvcmRFeGlzdHMgLSByZXR1cm4gcmVjb3JkIGFscmVhZHkgZXhpc3RzIGVycm9yIG1lc3NhZ2UgdG8gdGhlIE1JCgkqLwoJQ2xvc3VyZSByZWNvcmRFeGlzdHMgPSB7CgkJbWkuZXJyb3IoIlJlY29yZCBhbHJlYWR5IGV4aXN0cyIpOwoJfQoKICAvKgogICogSGVscGVycwogICovCgoJcHJpdmF0ZSB2b2lkIHRyeVBhcnNlRGF0ZShTdHJpbmcgc3RyaW5nVG9QYXJzZSl7CgkJaWYgKGlzU3RyaW5nTnVsbE9yRW1wdHkoc3RyaW5nVG9QYXJzZSkpIHsKCQkJaWYoc3RyaW5nVG9QYXJzZS5sZW5ndGgoKSAhPSA4KXsKCQkJCW1pLmVycm9yKCJEYXRlIGxlbmd0aCBtdXN0IGJlIDgiKTsKCQkJfQoJCQl0cnkgewoJCQkJTG9jYWxEYXRlLnBhcnNlKHN0cmluZ1RvUGFyc2UsIERhdGVUaW1lRm9ybWF0dGVyLm9mUGF0dGVybigieXl5eU1NZGQiKSkKCQkJfSBjYXRjaCAoRGF0ZVRpbWVQYXJzZUV4Y2VwdGlvbiBlKSB7CgkJCQltaS5lcnJvcigiSW5jb3JyZWN0IGRhdGUgZm9ybWF0IHl5eXlNTWRkIC0gRFdEVCIpOwoJCQl9CgkJfQoJfQoJcHJpdmF0ZSBib29sZWFuIGlzU3RyaW5nTnVsbE9yRW1wdHkoU3RyaW5nIHN0cmluZ1RvVmFsaWRhdGUpewoJCXJldHVybiBzdHJpbmdUb1ZhbGlkYXRlID09IG51bGwgfHwgc3RyaW5nVG9WYWxpZGF0ZS5pc0VtcHR5KCk7Cgl9Cgp9Cg=="}}}