{"programModules":{"EXT102MI":{"program":"EXT102MI","triggers":{},"transactions":{"UpdPOLine":{"sourceUuid":"60cf27fe-1782-47ed-aa6a-06bbb37b9702","name":"UpdPOLine","program":"EXT102MI","description":"Upsert item supplier record, and log portal crud transaction","active":true,"multi":false,"modified":1715576532431,"modifiedBy":"RMURRAY","outputFields":[],"inputFields":[{"name":"PUNO","description":"purchase order number","length":10,"mandatory":true,"type":"A"},{"name":"PNLI","description":"purchase order line","length":6,"mandatory":true,"type":"A"},{"name":"PNLS","description":"purchase order line subnumber","length":3,"mandatory":true,"type":"A"},{"name":"PUPR","description":"purchase price","length":17,"mandatory":false,"type":"N"},{"name":"DWDT","description":"requested delivery date","length":8,"mandatory":false,"type":"N"},{"name":"PITD","description":"purchase order item name","length":60,"mandatory":false,"type":"A"},{"name":"PITT","description":"purchase order item description","length":120,"mandatory":false,"type":"A"},{"name":"TEL1","description":"terms text","length":36,"mandatory":false,"type":"A"},{"name":"EMAL","description":"portal user","length":100,"mandatory":false,"type":"A"},{"name":"PIT2","description":"Old descr","length":120,"mandatory":false,"type":"A"},{"name":"PITO","description":"Old name","length":60,"mandatory":false,"type":"A"},{"name":"PUPO","description":"Old price","length":17,"mandatory":false,"type":"N"},{"name":"DWDO","description":"Old deliv date","length":8,"mandatory":false,"type":"N"},{"name":"TELO","description":"Old text","length":36,"mandatory":false,"type":"A"},{"name":"CRUD","description":"CRUD Action","length":3,"mandatory":true,"type":"A"}],"utilities":[]}},"batches":{},"advancedPrograms":{}}},"utilities":{},"sources":{"60cf27fe-1782-47ed-aa6a-06bbb37b9702":{"uuid":"60cf27fe-1782-47ed-aa6a-06bbb37b9702","updated":1715649878165,"updatedBy":"RMURRAY","created":1715574971797,"createdBy":"RMURRAY","apiVersion":"0.9","beVersion":"16.0.0.20240318172728.5","language":"GROOVY","codeHash":"80C0F50C30B104596B9AF8A055B9F9DC3CD1B1FFE500704E9EACEB5274AD9B2F","code":"LyoKICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgogKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgTk9USUNFICAgICAgICAgICAgICAgICAgICAgICAgICAgICoKICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgogKiAgIFRISVMgU09GVFdBUkUgSVMgVEhFIFBST1BFUlRZIE9GIEFORCBDT05UQUlOUyAgICAgICAgICAgICAqCiAqICAgQ09ORklERU5USUFMIElORk9STUFUSU9OIE9GIElORk9SIEFORC9PUiBJVFMgQUZGSUxJQVRFUyAgICoKICogICBPUiBTVUJTSURJQVJJRVMgQU5EIFNIQUxMIE5PVCBCRSBESVNDTE9TRUQgV0lUSE9VVCBQUklPUiAgKgogKiAgIFdSSVRURU4gUEVSTUlTU0lPTi4gTElDRU5TRUQgQ1VTVE9NRVJTIE1BWSBDT1BZIEFORCAgICAgICAqCiAqICAgQURBUFQgVEhJUyBTT0ZUV0FSRSBGT1IgVEhFSVIgT1dOIFVTRSBJTiBBQ0NPUkRBTkNFIFdJVEggICoKICogICBUSEUgVEVSTVMgT0YgVEhFSVIgU09GVFdBUkUgTElDRU5TRSBBR1JFRU1FTlQuICAgICAgICAgICAgKgogKiAgIEFMTCBPVEhFUiBSSUdIVFMgUkVTRVJWRUQuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqCiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoKICogICAoYykgQ09QWVJJR0hUIDIwMjAgSU5GT1IuICBBTEwgUklHSFRTIFJFU0VSVkVELiAgICAgICAgICAgKgogKiAgIFRIRSBXT1JEIEFORCBERVNJR04gTUFSS1MgU0VUIEZPUlRIIEhFUkVJTiBBUkUgICAgICAgICAgICAqCiAqICAgVFJBREVNQVJLUyBBTkQvT1IgUkVHSVNURVJFRCBUUkFERU1BUktTIE9GIElORk9SICAgICAgICAgICoKICogICBBTkQvT1IgSVRTIEFGRklMSUFURVMgQU5EIFNVQlNJRElBUklFUy4gQUxMIFJJR0hUUyAgICAgICAgKgogKiAgIFJFU0VSVkVELiAgQUxMIE9USEVSIFRSQURFTUFSS1MgTElTVEVEIEhFUkVJTiBBUkUgICAgICAgICAqCiAqICAgVEhFIFBST1BFUlRZIE9GIFRIRUlSIFJFU1BFQ1RJVkUgT1dORVJTLiAgICAgICAgICAgICAgICAgICoKICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKgogKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCiovCiAKaW1wb3J0IGdyb292eS5sYW5nLkNsb3N1cmU7CmltcG9ydCBncm9vdnkuanNvbi5Kc29uU2x1cnBlcjsKCmltcG9ydCBqYXZhLnRpbWUuTG9jYWxEYXRlOwppbXBvcnQgamF2YS50aW1lLkxvY2FsRGF0ZVRpbWU7CmltcG9ydCBqYXZhLnRpbWUuZm9ybWF0LkRhdGVUaW1lRm9ybWF0dGVyOwppbXBvcnQgamF2YS50aW1lLmZvcm1hdC5EYXRlVGltZVBhcnNlRXhjZXB0aW9uCmltcG9ydCBqYXZhLnRpbWUuWm9uZUlkOwoKaW1wb3J0IGphdmEudXRpbC5yZWdleC5QYXR0ZXJuOwppbXBvcnQgamF2YS51dGlsLnJlZ2V4Lk1hdGNoZXI7CmltcG9ydCBqYXZhLnV0aWwucmVnZXguUGF0dGVyblN5bnRheEV4Y2VwdGlvbjsKCgovKgoqTW9kaWZpY2F0aW9uIGFyZWEgLSBNMwoqTmJyICAgICBEYXRlICAgICAgVXNlciBpZCAgIERlc2NyaXB0aW9uCipFWFQxMDIgIDIwMjQwMTE2ICBSTVVSUkFZICAgVXBkYXRlIEVYVCBhcGkgdG8gaGFuZGxlIHBvcnRhbCB1cGRhdGVzIGFuZCBsb2dnaW5nCipFWFQxMDIgIDIwMjQwMjA1ICBSTVVSUkFZICAgVmFsaWRhdGlvbiBvbiBJT04gQVBJIGNhbGwuIAoqRVhUMTAyICAyMDI0MDQxNCAgUk1VUlJBWSAgIEFkZCBpbiBQTyBMaW5lIGNvbmZpcm1hdGlvbgoqRVhUMTAyICAyMDI0MDUwMSAgUk1VUlJBWSAgIFByZXBhcmUgZm9yIHN1Ym1pc3Npb24sIFBSRCBBcHByb3ZhbC4KKkVYVDEwMgkgMjAyNDA1MTQgIFJNVVJSQVkJIE1ha2luZyB1cGRhdGVzIGFzIHBlciByZXZpZXcgZmVlZGJhY2suCiovCgovKgoqIFVwZFBPTGluZQoqLwpwdWJsaWMgY2xhc3MgVXBkUE9MaW5lIGV4dGVuZHMgRXh0ZW5kTTNUcmFuc2FjdGlvbiB7CgoJcHJpdmF0ZSBmaW5hbCBNSUFQSSBtaTsKCXByaXZhdGUgZmluYWwgRGF0YWJhc2VBUEkgZGF0YWJhc2U7Cglwcml2YXRlIGZpbmFsIExvZ2dlckFQSSBsb2dnZXI7Cglwcml2YXRlIGZpbmFsIFByb2dyYW1BUEkgcHJvZ3JhbTsKCXByaXZhdGUgZmluYWwgSW9uQVBJIGlvbjsKCglwcml2YXRlIFN0cmluZyBwdW5vOwoJcHJpdmF0ZSBTdHJpbmcgcG5saTsKCXByaXZhdGUgU3RyaW5nIHBubHM7Cglwcml2YXRlIFN0cmluZyBwdXByOwoJcHJpdmF0ZSBTdHJpbmcgZHdkdDsKCXByaXZhdGUgU3RyaW5nIHBpdGQ7Cglwcml2YXRlIFN0cmluZyBwaXR0OwoJcHJpdmF0ZSBTdHJpbmcgdGVsMTsKCXByaXZhdGUgU3RyaW5nIGVtYWw7Cglwcml2YXRlIFN0cmluZyBzdW5vOwoJcHJpdmF0ZSBTdHJpbmcgaXRubzsKCXByaXZhdGUgU3RyaW5nIG9ycWE7Cglwcml2YXRlIFN0cmluZyBjcnVkOwoJcHJpdmF0ZSBTdHJpbmcgY2hpZDsKCXByaXZhdGUgU3RyaW5nIHB1cG87Cglwcml2YXRlIFN0cmluZyBkd2RvOwoJcHJpdmF0ZSBTdHJpbmcgcGl0bzsKCXByaXZhdGUgU3RyaW5nIHBpdDI7Cglwcml2YXRlIFN0cmluZyB0ZWxvOwoJcHJpdmF0ZSBTdHJpbmcgb3JxbzsKCXByaXZhdGUgU3RyaW5nIGN1cnJlbnREYXRlVGltZTsKCglwcml2YXRlIGludCBjdXJyZW50RGF0ZTsKCXByaXZhdGUgaW50IGN1cnJlbnRUaW1lOwoJcHJpdmF0ZSBpbnQgWFhDT05POwoKCXByaXZhdGUgYm9vbGVhbiBpc0RhdGVQYXJzZWQ7CgoJcHVibGljIFVwZFBPTGluZShNSUFQSSBtaSwgRGF0YWJhc2VBUEkgZGF0YWJhc2UsIExvZ2dlckFQSSBsb2dnZXIsIFByb2dyYW1BUEkgcHJvZ3JhbSwgSW9uQVBJIGlvbikgewoJCXRoaXMubWkgPSBtaTsKCQl0aGlzLmRhdGFiYXNlID0gZGF0YWJhc2U7CgkJdGhpcy5sb2dnZXIgPSBsb2dnZXI7CgkJdGhpcy5wcm9ncmFtID0gcHJvZ3JhbTsKCQl0aGlzLmlvbiA9IGlvbjsgCgl9CgoJcHVibGljIHZvaWQgbWFpbigpIHsKCQkvKioKCQkqRmV0Y2ggaW5wdXQgZmllbGRzIGZyb20gTUkKCQkqLwoJCXB1bm8gPSBtaS5pbkRhdGEuZ2V0KCJQVU5PIikgPT0gbnVsbCA/ICcnIDogbWkuaW5EYXRhLmdldCgiUFVOTyIpLnRyaW0oKTsKCQlpZiAocHVubyA9PSAiPyIpIHsKCQkJcHVubyA9ICIiOwoJCX0gCgkJcG5saSA9IG1pLmluRGF0YS5nZXQoIlBOTEkiKSA9PSBudWxsID8gJycgOiBtaS5pbkRhdGEuZ2V0KCJQTkxJIikudHJpbSgpOwoJCWlmIChwbmxpID09ICI/IikgewoJCQlwbmxpID0gIiI7CgkJfSAKCQlwbmxzID0gbWkuaW5EYXRhLmdldCgiUE5MUyIpID09IG51bGwgPyAnJyA6IG1pLmluRGF0YS5nZXQoIlBOTFMiKS50cmltKCk7CgkJaWYgKHBubHMgPT0gIj8iKSB7CgkJCXBubHMgPSAiIjsKCQl9IAoJCXRlbDEgPSBtaS5pbkRhdGEuZ2V0KCJURUwxIikgPT0gbnVsbCA/ICcnIDogbWkuaW5EYXRhLmdldCgiVEVMMSIpLnRyaW0oKTsKCQlpZiAodGVsMSA9PSAiPyIpIHsKCQkJdGVsMSA9ICIiOwoJCX0gCgkJcGl0ZCA9IG1pLmluRGF0YS5nZXQoIlBJVEQiKSA9PSBudWxsID8gJycgOiBtaS5pbkRhdGEuZ2V0KCJQSVREIikudHJpbSgpOwoJCWlmIChwaXRkID09ICI/IikgewoJCQlwaXRkID0gIiI7CgkJfSAKCQlwaXR0ID0gbWkuaW5EYXRhLmdldCgiUElUVCIpID09IG51bGwgPyAnJyA6IG1pLmluRGF0YS5nZXQoIlBJVFQiKS50cmltKCk7CgkJaWYgKHBpdHQgPT0gIj8iKSB7CgkJCXBpdHQgPSAiIjsKCQl9IAoJCXB1cHIgPSBtaS5pbkRhdGEuZ2V0KCJQVVBSIikgPT0gbnVsbCA/ICcnIDogbWkuaW5EYXRhLmdldCgiUFVQUiIpLnRyaW0oKTsKCQlpZiAocHVwciA9PSAiPyIpIHsKCQkJcHVwciA9ICIiOwoJCX0gICAgIAoJCWR3ZHQgPSBtaS5pbkRhdGEuZ2V0KCJEV0RUIikgPT0gbnVsbCA/ICcnIDogbWkuaW5EYXRhLmdldCgiRFdEVCIpLnRyaW0oKTsKCQlpZiAoZHdkdCA9PSAiPyIpIHsKCQkJZHdkdCA9ICIiOwoJCX0gCgkJdGVsMSA9IG1pLmluRGF0YS5nZXQoIlRFTDEiKSA9PSBudWxsID8gJycgOiBtaS5pbkRhdGEuZ2V0KCJURUwxIikudHJpbSgpOwoJCWlmICh0ZWwxID09ICI/IikgewoJCQl0ZWwxID0gIiI7CgkJfSAKCQllbWFsID0gbWkuaW5EYXRhLmdldCgiRU1BTCIpID09IG51bGwgPyAnJyA6IG1pLmluRGF0YS5nZXQoIkVNQUwiKS50cmltKCk7CgkJaWYgKGVtYWwgPT0gIj8iKSB7CgkJCWVtYWwgPSAiIjsKCQl9IAoJCXBpdDIgPSBtaS5pbkRhdGEuZ2V0KCJQSVQyIikgPT0gbnVsbCA/ICcnIDogbWkuaW5EYXRhLmdldCgiUElUMiIpLnRyaW0oKTsKCQlpZiAocGl0MiA9PSAiPyIpIHsKCQkJcGl0MiA9ICIiOwoJCX0gCgkJcGl0byA9IG1pLmluRGF0YS5nZXQoIlBJVE8iKSA9PSBudWxsID8gJycgOiBtaS5pbkRhdGEuZ2V0KCJQSVRPIikudHJpbSgpOwoJCWlmIChwaXRvID09ICI/IikgewoJCQlwaXRvID0gIiI7CgkJfSAKCQlwdXBvID0gbWkuaW5EYXRhLmdldCgiUFVQTyIpID09IG51bGwgPyAnJyA6IG1pLmluRGF0YS5nZXQoIlBVUE8iKS50cmltKCk7CgkJaWYgKHB1cG8gPT0gIj8iKSB7CgkJCXB1cG8gPSAiIjsKCQl9ICAgICAKCQlkd2RvID0gbWkuaW5EYXRhLmdldCgiRFdETyIpID09IG51bGwgPyAnJyA6IG1pLmluRGF0YS5nZXQoIkRXRE8iKS50cmltKCk7CgkJaWYgKGR3ZG8gPT0gIj8iKSB7CgkJCWR3ZG8gPSAiIjsKCQl9IAoJCXRlbG8gPSBtaS5pbkRhdGEuZ2V0KCJURUxPIikgPT0gbnVsbCA/ICcnIDogbWkuaW5EYXRhLmdldCgiVEVMTyIpLnRyaW0oKTsKCQlpZiAodGVsbyA9PSAiPyIpIHsKCQkJdGVsbyA9ICIiOwoJCX0gCgkJY3J1ZCA9IG1pLmluRGF0YS5nZXQoIkNSVUQiKSA9PSBudWxsID8gJycgOiBtaS5pbkRhdGEuZ2V0KCJDUlVEIikudHJpbSgpOwoJCWlmIChjcnVkID09ICI/IikgewoJCQljcnVkID0gIiI7CgkJfSAKCgkJLyoKCQkqIFNldCBjb21wYW55IG51bWJlcgoJCSovCgkJWFhDT05PPSBwcm9ncmFtLkxEQVpELkNPTk87CgkJLyoKCQkqIFNldCBwcm9ncmFtIHVzZXIgYXMgY2hpZCB1c2VyCgkJKi8KCQljaGlkID0gcHJvZ3JhbS5nZXRVc2VyKCk7CgoJCS8qCgkJKiBQZXJmb3JtIHZhbGlkYXRpb24gb24gaW5wdXQgdmFyaWFibGVzCgkJKiBOb3RlIHRvIHJldmlld2VyIC0gVmFsaWRhdGlvbiBub3QgcmVxdWlyZWQgb24gSVROTyBvciBTVU5PIGFzIHRoZXNlIGZpZWxkcyBhcmUgcmV0cmlldmVkIGJ5IHRoZSBhcGkgUFBTMjAwTUlfR2V0TGluZQoJCSovCgkJaWYgKCF2YWxpZGF0ZUlucHV0KCkpIHsKCQkJcmV0dXJuOwoJCX0KCgkJLyoKCQkqIFNldCBEYXRlIFZhcmlhYmxlcyB3aXRoIGN1c3RvbWVyIGxvY2FsIHRpbWUgem9uZQoJCSovCgkJWm9uZUlkIHppZCA9IFpvbmVJZC5vZigiQXVzdHJhbGlhL0JyaXNiYW5lIik7IAoJCWN1cnJlbnREYXRlID0gTG9jYWxEYXRlLm5vdyh6aWQpLmZvcm1hdChEYXRlVGltZUZvcm1hdHRlci5vZlBhdHRlcm4oInl5eXlNTWRkIikpLnRvSW50ZWdlcigpOwoJCWN1cnJlbnRUaW1lID0gSW50ZWdlci52YWx1ZU9mKExvY2FsRGF0ZVRpbWUubm93KCkuZm9ybWF0KERhdGVUaW1lRm9ybWF0dGVyLm9mUGF0dGVybigiSEhtbXNzIikpKTsKCQljdXJyZW50RGF0ZVRpbWUgPSAgKExvY2FsRGF0ZS5ub3coemlkKS5mb3JtYXQoRGF0ZVRpbWVGb3JtYXR0ZXIub2ZQYXR0ZXJuKCJkZCBNTU0geXl5eSIpKSArICIgIiArIExvY2FsRGF0ZVRpbWUubm93KCkuZm9ybWF0KERhdGVUaW1lRm9ybWF0dGVyLm9mUGF0dGVybigiSEg6bW06c3MiKSkpLnRvU3RyaW5nKCkgKyAiIEFFU1QiOyAKCgkJLyoKCQkqIFJldHJpZXZlIHB1cmNoYXNlIG9yZGVyIGxpbmUgaW5mb3JtYXRpb24gdmlhIEFQSSBQUFMyMDBNSV9HZXRMaW5lCgkJKi8KCQlNYXA8U3RyaW5nLCBTdHJpbmc+IHBhcmFtc1BPTGluZSA9IFsgIkNPTk8iOiBYWENPTk8udG9TdHJpbmcoKSwgIlBVTk8iOiBwdW5vLCAiUE5MSSI6IHBubGksICJQTkxTIjogcG5scyBdOwoJCVN0cmluZyB1cmxQT0xpbmUgPSAiL00zL20zYXBpLXJlc3QvdjIvZXhlY3V0ZS9QUFMyMDBNSS9HZXRMaW5lIjsKCgkJTWFwPFN0cmluZyxTdHJpbmc+IGhlYWRlcnNQT0xpbmUgPSBbIkFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uIl07CgkJSW9uUmVzcG9uc2UgcmVzcG9uc2VQT0xpbmUgPSBpb24uZ2V0KHVybFBPTGluZSwgaGVhZGVyc1BPTGluZSwgcGFyYW1zUE9MaW5lKTsKCgkJaWYocmVzcG9uc2VQT0xpbmUuZ2V0RXJyb3IoKSl7CgkJCWxvZ2dlci5kZWJ1ZygiRmFpbGVkIGNhbGxpbmcgSU9OIEFQSSAke3VybFBPTGluZX0sIGRldGFpbGVkIGVycm9yIG1lc3NhZ2U6ICR7cmVzcG9uc2VQT0xpbmUuZ2V0RXJyb3JNZXNzYWdlKCl9Iik7CgkJCW1pLmVycm9yKCJjYWxsaW5nIGFwaSBmYWlsZWQgJHt1cmxQT0xpbmV9ICIgKyByZXNwb25zZVBPTGluZS5nZXRFcnJvck1lc3NhZ2UoKSk7CgkJCXJldHVybjsKCQl9CgoJCWlmIChyZXNwb25zZVBPTGluZS5nZXRTdGF0dXNDb2RlKCkgIT0gMjAwKSB7CgkJCW1pLmVycm9yKCJJbmNvcnJlY3Qgc3RhdHVzLCBubyBwYXlsb2FkIik7CgkJCXJldHVybjsKCQl9IAoJCQkKCQkvKgoJCSogSWYgcGF5bG9hZCBpcyBmb3IgUE8gQ29uZmlybWF0aW9uICJDTkYiCgkJKi8KCQlpZihjcnVkID09ICJDTkYiKXsKCgkJCUpzb25TbHVycGVyIGpzb25TbHVycGVyID0gbmV3IEpzb25TbHVycGVyKCk7CgkJCU1hcDxTdHJpbmcsIE9iamVjdD4gbWlSZXNwb25zZSA9IChNYXA8U3RyaW5nLCBPYmplY3Q+KSBqc29uU2x1cnBlci5wYXJzZVRleHQocmVzcG9uc2VQT0xpbmUuZ2V0Q29udGVudCgpKTsKCQkJQXJyYXlMaXN0PE1hcDxTdHJpbmcsIE9iamVjdD4+IHJlc3VsdHMgPSAoQXJyYXlMaXN0PE1hcDxTdHJpbmcsIE9iamVjdD4+KSBtaVJlc3BvbnNlLmdldCgicmVzdWx0cyIpOwoJCQlBcnJheUxpc3Q8TWFwPFN0cmluZywgU3RyaW5nPj4gcmVjb3JkTGlzdCA9IChBcnJheUxpc3Q8TWFwPFN0cmluZywgU3RyaW5nPj4pIHJlc3VsdHNbMF1bInJlY29yZHMiXTsKCQkJcmVjb3JkTGlzdC5lYWNoV2l0aEluZGV4IHsgaXQsIGluZGV4IC0+CgkJCQlNYXA8U3RyaW5nLCBTdHJpbmc+IHJlY29yZE1QTElORSA9IChNYXA8U3RyaW5nLCBTdHJpbmc+KSBpdDsKCQkJCWlmIChyZWNvcmRNUExJTkUuU1VOTyAhPSBudWxsKSB7CgkJCQkJaXRubyA9IHJlY29yZE1QTElORS5JVE5POwoJCQkJCXN1bm8gPSByZWNvcmRNUExJTkUuU1VOTzsKCQkJCQlvcnFvID0gcmVjb3JkTVBMSU5FLk9SUUE7CgkJCQkJb3JxYSA9IHJlY29yZE1QTElORS5PUlFBOwoJCQkJCWlmKCFpc1N0cmluZ051bGxPckVtcHR5KHB1cHIpICYmIGlzU3RyaW5nTnVsbE9yRW1wdHkocHVwbykpewoJCQkJCQlwdXBvID0gcmVjb3JkTVBMSU5FLlBVUFI7ICAKCQkJCQl9CgkJCQkJaWYoIWlzU3RyaW5nTnVsbE9yRW1wdHkoZHdkdCkgJiYgaXNTdHJpbmdOdWxsT3JFbXB0eShkd2RvKSl7CgkJCQkJCWR3ZG8gPSByZWNvcmRNUExJTkUuRFdEVDsKCQkJCQl9CgkJCQl9CgkJCX0KCQkKCQkJLyoKCQkJKiBQZXJmb3JtIFBPIExpbmUgQ29uZmlybWF0aW9uIHZpYSBBUEkgUFBTMTAwTUlfQ29uZmlybUxpbmUKCQkJKi8KCQkJTWFwPFN0cmluZywgU3RyaW5nPiBwYXJhbXMgPSBbICJQVU5PIjogcHVubywgICJQTkxJIjogcG5saSwgIlBOTFMiOiBwbmxzIF07CgkJCVN0cmluZyB1cmxDb25maXJtTGluZSA9ICIvTTMvbTNhcGktcmVzdC92Mi9leGVjdXRlL1BQUzAwMU1JL0NvbmZpcm1MaW5lIjsKCgkJCWlmKCFpc1N0cmluZ051bGxPckVtcHR5KHB1cHIpKXsKCQkJCXBhcmFtcy5wdXQoIlBVUFIiLCBwdXByKTsKCQkJfQoJCQlpZighaXNTdHJpbmdOdWxsT3JFbXB0eShkd2R0KSl7CgkJCQlwYXJhbXMucHV0KCJEV0RUIiwgZHdkdCk7CgkJCX0KCQkJTWFwPFN0cmluZyxTdHJpbmc+IGhlYWRlcnMgPSBbIkFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uIl07CgkJCUlvblJlc3BvbnNlIHJlc3BvbnNlID0gaW9uLmdldCh1cmxDb25maXJtTGluZSwgaGVhZGVycywgcGFyYW1zKTsKCQkJaWYocmVzcG9uc2UuZ2V0RXJyb3IoKSl7CgkJCQlsb2dnZXIuZGVidWcoIkZhaWxlZCBjYWxsaW5nIElPTiBBUEkgJHt1cmxDb25maXJtTGluZX0sIGRldGFpbGVkIGVycm9yIG1lc3NhZ2U6ICR7cmVzcG9uc2UuZ2V0RXJyb3JNZXNzYWdlKCl9Iik7CgkJCQltaS5lcnJvcigiY2FsbGluZyBhcGkgZmFpbGVkICR7dXJsQ29uZmlybUxpbmV9ICIgKyByZXNwb25zZS5nZXRFcnJvck1lc3NhZ2UoKSk7CgkJCQlyZXR1cm47CgkJCX0KICAgICAgCiAgICAJfSBlbHNlIHsKCQkJLyoKCQkJKiBJZiBwYXlsb2FkIGlzIG5vdCBmb3IgUE8gTGluZSBDb25maXJtYXRpb24sIEFzc3VtZWQgYXMgYSBQTyBMaW5lIFVwZGF0ZS4KCQkJKi8KCQkJSnNvblNsdXJwZXIganNvblNsdXJwZXIgPSBuZXcgSnNvblNsdXJwZXIoKTsKCQkJTWFwPFN0cmluZywgT2JqZWN0PiBtaVJlc3BvbnNlID0gKE1hcDxTdHJpbmcsIE9iamVjdD4pIGpzb25TbHVycGVyLnBhcnNlVGV4dChyZXNwb25zZVBPTGluZS5nZXRDb250ZW50KCkpOwoJCQlBcnJheUxpc3Q8TWFwPFN0cmluZywgT2JqZWN0Pj4gcmVzdWx0cyA9IChBcnJheUxpc3Q8TWFwPFN0cmluZywgT2JqZWN0Pj4pIG1pUmVzcG9uc2UuZ2V0KCJyZXN1bHRzIik7CgkJCUFycmF5TGlzdDxNYXA8U3RyaW5nLCBTdHJpbmc+PiByZWNvcmRMaXN0ID0gKEFycmF5TGlzdDxNYXA8U3RyaW5nLCBTdHJpbmc+PikgcmVzdWx0c1swXVsicmVjb3JkcyJdOwoJCQlyZWNvcmRMaXN0LmVhY2hXaXRoSW5kZXggeyBpdCwgaW5kZXggLT4KCQkJCU1hcDxTdHJpbmcsIFN0cmluZz4gcmVjb3JkTVBMSU5FID0gKE1hcDxTdHJpbmcsIFN0cmluZz4pIGl0OwoJCQkJaWYgKHJlY29yZE1QTElORS5TVU5PICE9IG51bGwpIHsKCQkJCQlpdG5vID0gcmVjb3JkTVBMSU5FLklUTk87CgkJCQkJc3VubyA9IHJlY29yZE1QTElORS5TVU5POwoJCQkJCW9ycW8gPSByZWNvcmRNUExJTkUuT1JRQTsKCQkJCQlvcnFhID0gcmVjb3JkTVBMSU5FLk9SUUE7CgkJCQkJaWYoaXNTdHJpbmdOdWxsT3JFbXB0eShwdXBvKSl7CgkJCQkJCXB1cG8gPSByZWNvcmRNUExJTkUuUFVQUjsgIAoJCQkJCX0KCQkJCQlpZihpc1N0cmluZ051bGxPckVtcHR5KHRlbG8pKXsKCQkJCQkJdGVsbyA9IHJlY29yZE1QTElORS5URUwxOyAgCgkJCQkJfQoJCQkJCWlmKGlzU3RyaW5nTnVsbE9yRW1wdHkocGl0bykpewoJCQkJCQlwaXRvID0gcmVjb3JkTVBMSU5FLlBJVEQ7CgkJCQkJfQoJCQkJCWlmKGlzU3RyaW5nTnVsbE9yRW1wdHkocGl0MikpewoJCQkJCQlwaXQyID0gcmVjb3JkTVBMSU5FLlBJVFQ7CgkJCQkJfQoJCQkJCWlmKGlzU3RyaW5nTnVsbE9yRW1wdHkoZHdkbykpewoJCQkJCQlkd2RvID0gcmVjb3JkTVBMSU5FLkRXRFQ7CgkJCQkJfQoJCQkJfQoJCQl9CgkJfQoJCQoJCS8qCgkJKiBQZXJmb3JtIFVwZGF0ZSBvbiBQTyBMaW5lIHZpYSBBUEkgUFBTMjAwTUlfVXBkTGluZQoJCSovCgkJTWFwPFN0cmluZywgU3RyaW5nPiBwYXJhbXMgPSBuZXcgSGFzaE1hcDxTdHJpbmcsU3RyaW5nPigpOwoJCVN0cmluZyB1cmxVcGRMaW5lID0gIi9NMy9tM2FwaS1yZXN0L3YyL2V4ZWN1dGUvUFBTMjAwTUkvVXBkTGluZSI7CgkJcGFyYW1zID0gWyAiUFVOTyI6IHB1bm8sICAiUE5MSSI6IHBubGksICJQTkxTIjogcG5scyBdOwoJCWlmKCFpc1N0cmluZ051bGxPckVtcHR5KHB1cHIpKXsKCQkJcGFyYW1zLnB1dCgiUFVQUiIsIHB1cHIpOwoJCX0KCQlpZighaXNTdHJpbmdOdWxsT3JFbXB0eShkd2R0KSl7CgkJCXBhcmFtcy5wdXQoIkRXRFQiLCBkd2R0KTsKCQl9CgkJaWYoIWlzU3RyaW5nTnVsbE9yRW1wdHkocGl0ZCkpewoJCQlwYXJhbXMucHV0KCJQSVREIiwgcGl0ZCk7CgkJfQoJCWlmKCFpc1N0cmluZ051bGxPckVtcHR5KHBpdHQpKXsKCQkJcGFyYW1zLnB1dCgiUElUVCIsIHBpdHQpOwoJCX0KCQlpZighaXNTdHJpbmdOdWxsT3JFbXB0eSh0ZWwxKSl7CgkJCXBhcmFtcy5wdXQoIlRFTDEiLCB0ZWwxKTsKCQl9CgkJTWFwPFN0cmluZyxTdHJpbmc+IGhlYWRlcnMgPSBbIkFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uIl07CgkJSW9uUmVzcG9uc2UgcmVzcG9uc2UgPSBpb24uZ2V0KHVybFVwZExpbmUsIGhlYWRlcnMsIHBhcmFtcyk7CgkJaWYocmVzcG9uc2UuZ2V0RXJyb3IoKSl7CgkJCWxvZ2dlci5kZWJ1ZygiRmFpbGVkIGNhbGxpbmcgSU9OIEFQSSAke3VybFVwZExpbmV9LCBkZXRhaWxlZCBlcnJvciBtZXNzYWdlOiAke3Jlc3BvbnNlLmdldEVycm9yTWVzc2FnZSgpfSIpOwoJCQltaS5lcnJvcigiY2FsbGluZyBhcGkgZmFpbGVkICR7dXJsVXBkTGluZX0gIiArIHJlc3BvbnNlLmdldEVycm9yTWVzc2FnZSgpKTsKCQkJcmV0dXJuOwoJCX0KCQkKCQkvKgoJCSogV3JpdGUgbG9nIHZhbHVlcyB0byBleHRlbnNpb24gdGFibGUgRVhUU1BaCgkJKi8KCQl3cml0ZUVYVCgpOwogIAkgIAoJfQoKCS8qCgkqIHZhbGlkYXRlSW5wdXQgLSBWYWxpZGF0ZSBhbGwgdGhlIGlucHV0IGZpZWxkcwoJKiBAcmV0dXJuIGZhbHNlIGlmIHRoZXJlIGlzIGFueSBlcnJvcgoJKiAgICAgICAgIHRydWUgaWYgcGFzcyB0aGUgdmFsaWRhdGlvbgoJKi8KCXByaXZhdGUgYm9vbGVhbiB2YWxpZGF0ZUlucHV0KCl7CgoKCQkvKgoJCSogQ1JVRCBmaWVsZCBtdXN0IG5vdCBiZSBudWxsIG9yIGVtcHR5CgkJKi8KCQlpZihpc1N0cmluZ051bGxPckVtcHR5KGNydWQpKXsKCQkJbG9nZ2VyLmRlYnVnKCJtaS5lcnJvcjogQ1JVRCB2YWx1ZSBpcyBudWxsIG9yIGVtcHR5Iik7CgkJCW1pLmVycm9yKCJDcnVkIHZhbHVlIG5vdCBzcGVjaWZpZWQiKQoJCQlyZXR1cm4gZmFsc2U7CgkJfSAKCgkJLyoKCQkqIENSVUQgbXVzdCBiZSBVUEQgb3IgQ05GCgkJKi8KCQlpZihjcnVkICE9ICJVUEQiICYmIGNydWQgIT0gIkNORiIpewoJCQlsb2dnZXIuZGVidWcoIm1pLmVycm9yOiBDUlVEIGlucHV0IGlzIGluY29ycmVjdCAiICsgY3J1ZCk7CgkJCW1pLmVycm9yKCJDUlVEIG11c3QgYmUgVVBEIG9yIENORiIpOwoJCQlyZXR1cm4gZmFsc2U7CgkJfQoKCQkvKgoJCSogVmFsaWRhdGUga2V5IGZpZWxkcyB1c2VkIGZvciBhcGkgY2FsbAoJCSovCgkJU3RyaW5nIHB1cmNoYXNlT3JkZXJMaW5lID0gaXNTdHJpbmdOdWxsT3JFbXB0eShwdW5vKSA/ICJQVU5PIiA6IGlzU3RyaW5nTnVsbE9yRW1wdHkocG5saSkgPyAiUE5MSSIgOiBpc1N0cmluZ051bGxPckVtcHR5KHBubHMpID8gIlBOTFMiIDogIiI7CgkJaWYgKCFpc1N0cmluZ051bGxPckVtcHR5KHB1cmNoYXNlT3JkZXJMaW5lKSkgewoJCQltaS5lcnJvcigiJHtwdXJjaGFzZU9yZGVyTGluZX0sIG5vdCBkZWZpbmVkIik7CgkJCXJldHVybiBmYWxzZTsKCQl9CgoJCS8qCgkJKiBWYWxpZGF0ZSBkd2R0IGFzIGRhdGUgTW92ZXhEYXRlIFlETTggWVlZWU1NREQKCQkqLwoJCWlmKGNydWQgPT0gIkNORiIpIHsKCQkJLypWYWxpZGF0ZSBkd2R0IGFzIGRhdGUgTW92ZXhEYXRlKi8KCQkJaWYoIWlzU3RyaW5nTnVsbE9yRW1wdHkoZHdkdCkpewoJCQkJdHJ5UGFyc2VEYXRlKGR3ZHQpOwoJCQl9CgkJCS8qVmFsaWRhdGUgZHdkbyBhcyBkYXRlIE1vdmV4RGF0ZSovCgkJCWlmKCFpc1N0cmluZ051bGxPckVtcHR5KGR3ZG8pKXsKCQkJCXRyeVBhcnNlRGF0ZShkd2RvKTsKCQkJfQoJCX0gZWxzZSB7CgkJCXRyeVBhcnNlRGF0ZShkd2R0KTsKCQkJLypWYWxpZGF0ZSBkd2RvIGFzIGRhdGUgTW92ZXhEYXRlKi8KCQkJaWYoIWlzU3RyaW5nTnVsbE9yRW1wdHkoZHdkbykpewoJCQkJdHJ5UGFyc2VEYXRlKGR3ZG8pOwoJCQl9CgkJfQoKCQkvKgoJCSogVmFsaWRhdGUgdXNlciBlbWFpbCBub3QgZW1wdHkKCQkqLwoJCWlmKCFpc0VtYWlsRm9ybWF0KGVtYWwpKXsKCQkJbWkuZXJyb3IoIkludmFsaWQgZW1haWwgYWRkcmVzcyAtIEVNQUwiKTsKCQkJcmV0dXJuIGZhbHNlOwoJCX0KCgkJLyoKCQkqIFZhbGlkYXRpb24gU3VjY2Vzc2Z1bAoJCSovCgkJcmV0dXJuIHRydWU7Cgl9CgoJLyoKCSogd3JpdGVFWFQKCSogQ3JlYXRlIGxvZyBlbnRyeSBpbiB0YWJsZSBFWFRTUFoKCSovCglwcml2YXRlIHZvaWQgd3JpdGVFWFQoKSB7CgkJREJBY3Rpb24gYWN0aW9uRVhUU1BaID0gZGF0YWJhc2UudGFibGUoIkVYVFNQWiIpLmJ1aWxkKCk7CgkJREJDb250YWluZXIgRVhUU1BaID0gYWN0aW9uRVhUU1BaLmdldENvbnRhaW5lcigpOwoJCUVYVFNQWi5zZXQoIkVYQ09OTyIsIFhYQ09OTyk7CgkJRVhUU1BaLnNldCgiRVhTVU5PIiwgc3Vubyk7CgkJRVhUU1BaLnNldCgiRVhJVE5PIiwgaXRubyk7CgkJRVhUU1BaLnNldCgiRVhQVU5PIiwgcHVubyk7CgkJRVhUU1BaLnNldCgiRVhQTkxJIiwgcG5saS50b0ludGVnZXIoKSk7CgkJRVhUU1BaLnNldCgiRVhQTkxTIiwgcG5scy50b0ludGVnZXIoKSk7CgkJRVhUU1BaLnNldCgiRVhPUlFBIiwgb3JxYS50b0RvdWJsZSgpKTsKCQlFWFRTUFouc2V0KCJFWE9SUU8iLCBvcnFvLnRvRG91YmxlKCkpOwoJCWlmKCFpc1N0cmluZ051bGxPckVtcHR5KHB1cHIpKXsKCQkJRVhUU1BaLnNldCgiRVhQVVBSIiwgcHVwci50b0RvdWJsZSgpKTsKCQkJaWYoIWlzU3RyaW5nTnVsbE9yRW1wdHkocHVwbykpewoJCQkJRVhUU1BaLnNldCgiRVhQVVBPIiwgcHVwby50b0RvdWJsZSgpKTsKCQkJfQoJCX0KCQlpZighaXNTdHJpbmdOdWxsT3JFbXB0eShkd2R0KSl7CgkJCUVYVFNQWi5zZXQoIkVYRFdEVCIsIGR3ZHQudG9JbnRlZ2VyKCkpOwoJCQlpZighaXNTdHJpbmdOdWxsT3JFbXB0eShkd2RvKSl7IAoJCQkJRVhUU1BaLnNldCgiRVhEV0RPIiwgZHdkby50b0ludGVnZXIoKSk7CgkJCX0KCQl9CgkJaWYoIWlzU3RyaW5nTnVsbE9yRW1wdHkocGl0ZCkpewoJCQlFWFRTUFouc2V0KCJFWFBJVEQiLCBwaXRkKTsKCQkJaWYoaXNTdHJpbmdOdWxsT3JFbXB0eShwaXRvKSl7CgkJCQlFWFRTUFouc2V0KCJFWFBJVE8iLCBwaXRvKTsKCQkJfQoJCX0KCQlpZighaXNTdHJpbmdOdWxsT3JFbXB0eShwaXR0KSl7CgkJCUVYVFNQWi5zZXQoIkVYUElUVCIsIHBpdHQpOwoJCQlpZighaXNTdHJpbmdOdWxsT3JFbXB0eShwaXQyKSl7CgkJCQlFWFRTUFouc2V0KCJFWFBJVDIiLCBwaXQyKTsKCQkJfQoJCX0KCQlpZighaXNTdHJpbmdOdWxsT3JFbXB0eSh0ZWwxKSl7CgkJCUVYVFNQWi5zZXQoIkVYVEVMMSIsIHRlbDEpOwoJCQlpZighaXNTdHJpbmdOdWxsT3JFbXB0eSh0ZWxvKSl7CgkJCQlFWFRTUFouc2V0KCJFWFRFTE8iLCB0ZWxvKTsKCQkJfQoJCX0KCQlFWFRTUFouc2V0KCJFWEVNQUwiLCBlbWFsKTsKCQlFWFRTUFouc2V0KCJFWExNRFQiLCBjdXJyZW50RGF0ZS50b0ludGVnZXIoKSk7CgkJRVhUU1BaLnNldCgiRVhMTVRNIiwgY3VycmVudFRpbWUudG9JbnRlZ2VyKCkpOwoJCUVYVFNQWi5zZXQoIkVYRFRYWCIsIGN1cnJlbnREYXRlVGltZSk7CgkJRVhUU1BaLnNldCgiRVhDUlVEIiwgY3J1ZCk7IAoJCUVYVFNQWi5zZXQoIkVYQ0hJRCIsIGNoaWQpOwoJCUVYVFNQWi5zZXQoIkVYQ0hOTyIsIDApOyAKCQlFWFRTUFouc2V0KCJFWFJHRFQiLCBjdXJyZW50RGF0ZSk7CgkJRVhUU1BaLnNldCgiRVhSR1RNIiwgY3VycmVudFRpbWUpOwoJCWFjdGlvbkVYVFNQWi5pbnNlcnQoRVhUU1BaLCByZWNvcmRFeGlzdHMpOwoJfQoJCgkvKgoJKiByZWNvcmRFeGlzdHMgLSByZXR1cm4gcmVjb3JkIGFscmVhZHkgZXhpc3RzIGVycm9yIG1lc3NhZ2UgdG8gdGhlIE1JCgkqLwoJQ2xvc3VyZSByZWNvcmRFeGlzdHMgPSB7CgkJbWkuZXJyb3IoIlJlY29yZCBhbHJlYWR5IGV4aXN0cyIpOwoJfQoKCS8qKioqKioqKgoJKiBIZWxwZXJzCgkqLwoJLyoKCSogQ2hlY2tzIGlmIHRoZSBkYXRlIGlzIGNvcnJlY3QgZm9ybWF0IGZvciBNb3ZleERhdGUgWVlZWU1NREQgWURNOAoJKi8KCXByaXZhdGUgdm9pZCB0cnlQYXJzZURhdGUoU3RyaW5nIHN0cmluZ1RvUGFyc2UpewoJCWlmIChpc1N0cmluZ051bGxPckVtcHR5KHN0cmluZ1RvUGFyc2UpKSB7CgkJCWlmKHN0cmluZ1RvUGFyc2UubGVuZ3RoKCkgIT0gOCl7CgkJCQltaS5lcnJvcigiRGF0ZSBsZW5ndGggbXVzdCBiZSA4Iik7CgkJCQlyZXR1cm47CgkJCX0KCQkJdHJ5IHsKCQkJCUxvY2FsRGF0ZS5wYXJzZShzdHJpbmdUb1BhcnNlLCBEYXRlVGltZUZvcm1hdHRlci5vZlBhdHRlcm4oInl5eXlNTWRkIikpCgkJCX0gY2F0Y2ggKERhdGVUaW1lUGFyc2VFeGNlcHRpb24gZSkgewoJCQkJbWkuZXJyb3IoIkluY29ycmVjdCBkYXRlIGZvcm1hdCB5eXl5TU1kZCIpOwoJCQkJcmV0dXJuOwoJCQl9CgkJfQoJfQoJCgkvKgoJKiBDaGVja3MgaWYgdGhlIHN0cmluZyBpcyBudWxsIG9yIGVtcHR5LgoJKi8KCXByaXZhdGUgYm9vbGVhbiBpc1N0cmluZ051bGxPckVtcHR5KFN0cmluZyBzdHJpbmdUb1ZhbGlkYXRlKXsKCQlyZXR1cm4gc3RyaW5nVG9WYWxpZGF0ZSA9PSBudWxsIHx8IHN0cmluZ1RvVmFsaWRhdGUuaXNFbXB0eSgpOwoJfQoKCS8qCgkqIENoZWNrcyBpZiBzdHJpbmcgaXMgbm90IG51bGwgb3IgZW1wdHksIGNvbnRhaW5zIHRoZSBAIHN5bWJvbAoJKiB1bmFibGUgdG8gdXNlIGphdmEudXRpbC5yZWdleCwgdW5hYmxlIHRvIHVzZSBQYXR0ZXJuU3ludGF4RXhjZXB0aW9uCgkqLwoJcHJpdmF0ZSBib29sZWFuIGlzRW1haWxGb3JtYXQoU3RyaW5nIHN0cmluZ1RvVmFsaWRhdGUpewoJCXJldHVybiAhaXNTdHJpbmdOdWxsT3JFbXB0eShzdHJpbmdUb1ZhbGlkYXRlKSAmJiBzdHJpbmdUb1ZhbGlkYXRlLmNvbnRhaW5zKCdAJykgJiYgIWlzU3RyaW5nTnVsbE9yRW1wdHkoc3RyaW5nVG9WYWxpZGF0ZS5zcGxpdCgnQCcpWzBdKSAmJiAhaXNTdHJpbmdOdWxsT3JFbXB0eShzdHJpbmdUb1ZhbGlkYXRlLnNwbGl0KCdAJylbMV0pICYmIHN0cmluZ1RvVmFsaWRhdGUuc3BsaXQoJ0AnKVsxXS5jb250YWlucygnLicpOwoJfQoKfQo="}}}
